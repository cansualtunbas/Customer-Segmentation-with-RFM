{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "a840c6af",
   "metadata": {
    "_cell_guid": "b1076dfc-b9ad-4769-8c92-a6c4dae69d19",
    "_uuid": "8f2839f25d086af736a60e9eeb907d3b93b6e0e5",
    "execution": {
     "iopub.execute_input": "2024-09-09T07:32:15.360521Z",
     "iopub.status.busy": "2024-09-09T07:32:15.360079Z",
     "iopub.status.idle": "2024-09-09T07:32:15.367993Z",
     "shell.execute_reply": "2024-09-09T07:32:15.366790Z"
    },
    "papermill": {
     "duration": 0.022348,
     "end_time": "2024-09-09T07:32:15.370700",
     "exception": false,
     "start_time": "2024-09-09T07:32:15.348352",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "#İş Problem(Business Problem)\n",
    "###############################################################\n",
    "# FLO müşterilerini segmentlere ayırıp bu segmentlere göre pazarlama stratejileri belirlemek istiyor.\n",
    "# Buna yönelik olarak müşterilerin davranışları tanımlanacak ve bu davranış öbeklenmelerine göre gruplar oluşturulacak..\n",
    "\n",
    "###############################################################\n",
    "# Veri Seti Hikayesi\n",
    "###############################################################\n",
    "\n",
    "# Veri seti son alışverişlerini 2020 - 2021 yıllarında OmniChannel(hem online hem offline alışveriş yapan) olarak yapan müşterilerin geçmiş alışveriş davranışlarından\n",
    "# elde edilen bilgilerden oluşmaktadır.\n",
    "\n",
    "# master_id: Eşsiz müşteri numarası\n",
    "# order_channel : Alışveriş yapılan platforma ait hangi kanalın kullanıldığı (Android, ios, Desktop, Mobile, Offline)\n",
    "# last_order_channel : En son alışverişin yapıldığı kanal\n",
    "# first_order_date : Müşterinin yaptığı ilk alışveriş tarihi\n",
    "# last_order_date : Müşterinin yaptığı son alışveriş tarihi\n",
    "# last_order_date_online : Muşterinin online platformda yaptığı son alışveriş tarihi\n",
    "# last_order_date_offline : Muşterinin offline platformda yaptığı son alışveriş tarihi\n",
    "# order_num_total_ever_online : Müşterinin online platformda yaptığı toplam alışveriş sayısı\n",
    "# order_num_total_ever_offline : Müşterinin offline'da yaptığı toplam alışveriş sayısı\n",
    "# customer_value_total_ever_offline : Müşterinin offline alışverişlerinde ödediği toplam ücret\n",
    "# customer_value_total_ever_online : Müşterinin online alışverişlerinde ödediği toplam ücret\n",
    "# interested_in_categories_12 : Müşterinin son 12 ayda alışveriş yaptığı kategorilerin listesi"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "d5e0ed36",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-09-09T07:32:15.390684Z",
     "iopub.status.busy": "2024-09-09T07:32:15.390173Z",
     "iopub.status.idle": "2024-09-09T07:32:15.396985Z",
     "shell.execute_reply": "2024-09-09T07:32:15.395659Z"
    },
    "papermill": {
     "duration": 0.020263,
     "end_time": "2024-09-09T07:32:15.399799",
     "exception": false,
     "start_time": "2024-09-09T07:32:15.379536",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    " #GÖREV 1: Veriyi Anlama (Data Understanding) ve Hazırlama\n",
    "           # 1. flo_data_20K.csv verisini okuyunuz. Dataframe’in kopyasını oluşturunuz.\n",
    "        \n",
    "           # 2. Veri setinde\n",
    "                     # a. İlk 10 gözlem,\n",
    "                     # b. Değişken isimleri,\n",
    "                     # c. Betimsel istatistik,\n",
    "                     # d. Boş değer,\n",
    "                     # e. Değişken tipleri, incelemesi yapınız.\n",
    "           # 3. Omnichannel müşterilerin hem online'dan hemde offline platformlardan alışveriş yaptığını ifade etmektedir. Herbir müşterinin toplam\n",
    "           # alışveriş sayısı ve harcaması için yeni değişkenler oluşturun.\n",
    "           # 4. Değişken tiplerini inceleyiniz. Tarih ifade eden değişkenlerin tipini date'e çeviriniz.\n",
    "           # 5. Alışveriş kanallarındaki müşteri sayısının, ortalama alınan ürün sayısının ve ortalama harcamaların dağılımına bakınız.\n",
    "           # 6. En fazla kazancı getiren ilk 10 müşteriyi sıralayınız.\n",
    "           # 7. En fazla siparişi veren ilk 10 müşteriyi sıralayınız.\n",
    "           # 8. Veri ön hazırlık sürecini fonksiyonlaştırınız."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "78d4e4ce",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-09-09T07:32:15.418697Z",
     "iopub.status.busy": "2024-09-09T07:32:15.418216Z",
     "iopub.status.idle": "2024-09-09T07:32:17.913773Z",
     "shell.execute_reply": "2024-09-09T07:32:17.912393Z"
    },
    "papermill": {
     "duration": 2.508578,
     "end_time": "2024-09-09T07:32:17.916792",
     "exception": false,
     "start_time": "2024-09-09T07:32:15.408214",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "import datetime as dt\n",
    "import pandas as pd\n",
    "import seaborn as sns\n",
    "from matplotlib import pyplot as plt\n",
    "pd.set_option('display.max_columns', None)\n",
    "pd.set_option('display.float_format', lambda x: '%.3f' % x)\n",
    "#1. flo_data_20K.csv verisini okuyunuz. Dataframe’in kopyasını oluşturunuz.\n",
    "df_=pd.read_csv(\"/kaggle/input/flo-data-20k/flo_data_20k.csv\")\n",
    "df = df_.copy()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "657be3a1",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-09-09T07:32:17.936965Z",
     "iopub.status.busy": "2024-09-09T07:32:17.935623Z",
     "iopub.status.idle": "2024-09-09T07:32:18.014556Z",
     "shell.execute_reply": "2024-09-09T07:32:18.011131Z"
    },
    "papermill": {
     "duration": 0.093015,
     "end_time": "2024-09-09T07:32:18.018321",
     "exception": false,
     "start_time": "2024-09-09T07:32:17.925306",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "master_id                             object\n",
       "order_channel                         object\n",
       "last_order_channel                    object\n",
       "first_order_date                      object\n",
       "last_order_date                       object\n",
       "last_order_date_online                object\n",
       "last_order_date_offline               object\n",
       "order_num_total_ever_online          float64\n",
       "order_num_total_ever_offline         float64\n",
       "customer_value_total_ever_offline    float64\n",
       "customer_value_total_ever_online     float64\n",
       "interested_in_categories_12           object\n",
       "dtype: object"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    " # 2. Veri setinde\n",
    "                     # a. İlk 10 gözlem,\n",
    "                     # b. Değişken isimleri,\n",
    "                     # c. Betimsel istatistik,\n",
    "                     # d. Boş değer,\n",
    "                     # e. Değişken tipleri, incelemesi yapınız.\n",
    "                        \n",
    "df.head(10)\n",
    "df.columns\n",
    "df.shape\n",
    "df.describe().T\n",
    "df.isnull().sum()\n",
    "df.dtypes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "4db95b61",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-09-09T07:32:18.039067Z",
     "iopub.status.busy": "2024-09-09T07:32:18.038116Z",
     "iopub.status.idle": "2024-09-09T07:32:18.066251Z",
     "shell.execute_reply": "2024-09-09T07:32:18.064999Z"
    },
    "papermill": {
     "duration": 0.04319,
     "end_time": "2024-09-09T07:32:18.070553",
     "exception": false,
     "start_time": "2024-09-09T07:32:18.027363",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>master_id</th>\n",
       "      <th>order_channel</th>\n",
       "      <th>last_order_channel</th>\n",
       "      <th>first_order_date</th>\n",
       "      <th>last_order_date</th>\n",
       "      <th>last_order_date_online</th>\n",
       "      <th>last_order_date_offline</th>\n",
       "      <th>order_num_total_ever_online</th>\n",
       "      <th>order_num_total_ever_offline</th>\n",
       "      <th>customer_value_total_ever_offline</th>\n",
       "      <th>customer_value_total_ever_online</th>\n",
       "      <th>interested_in_categories_12</th>\n",
       "      <th>total_order</th>\n",
       "      <th>total_spend</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>cc294636-19f0-11eb-8d74-000d3a38a36f</td>\n",
       "      <td>Android App</td>\n",
       "      <td>Offline</td>\n",
       "      <td>2020-10-30</td>\n",
       "      <td>2021-02-26</td>\n",
       "      <td>2021-02-21</td>\n",
       "      <td>2021-02-26</td>\n",
       "      <td>4.000</td>\n",
       "      <td>1.000</td>\n",
       "      <td>139.990</td>\n",
       "      <td>799.380</td>\n",
       "      <td>[KADIN]</td>\n",
       "      <td>5.000</td>\n",
       "      <td>939.370</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>f431bd5a-ab7b-11e9-a2fc-000d3a38a36f</td>\n",
       "      <td>Android App</td>\n",
       "      <td>Mobile</td>\n",
       "      <td>2017-02-08</td>\n",
       "      <td>2021-02-16</td>\n",
       "      <td>2021-02-16</td>\n",
       "      <td>2020-01-10</td>\n",
       "      <td>19.000</td>\n",
       "      <td>2.000</td>\n",
       "      <td>159.970</td>\n",
       "      <td>1853.580</td>\n",
       "      <td>[ERKEK, COCUK, KADIN, AKTIFSPOR]</td>\n",
       "      <td>21.000</td>\n",
       "      <td>2013.550</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>69b69676-1a40-11ea-941b-000d3a38a36f</td>\n",
       "      <td>Android App</td>\n",
       "      <td>Android App</td>\n",
       "      <td>2019-11-27</td>\n",
       "      <td>2020-11-27</td>\n",
       "      <td>2020-11-27</td>\n",
       "      <td>2019-12-01</td>\n",
       "      <td>3.000</td>\n",
       "      <td>2.000</td>\n",
       "      <td>189.970</td>\n",
       "      <td>395.350</td>\n",
       "      <td>[ERKEK, KADIN]</td>\n",
       "      <td>5.000</td>\n",
       "      <td>585.320</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1854e56c-491f-11eb-806e-000d3a38a36f</td>\n",
       "      <td>Android App</td>\n",
       "      <td>Android App</td>\n",
       "      <td>2021-01-06</td>\n",
       "      <td>2021-01-17</td>\n",
       "      <td>2021-01-17</td>\n",
       "      <td>2021-01-06</td>\n",
       "      <td>1.000</td>\n",
       "      <td>1.000</td>\n",
       "      <td>39.990</td>\n",
       "      <td>81.980</td>\n",
       "      <td>[AKTIFCOCUK, COCUK]</td>\n",
       "      <td>2.000</td>\n",
       "      <td>121.970</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>d6ea1074-f1f5-11e9-9346-000d3a38a36f</td>\n",
       "      <td>Desktop</td>\n",
       "      <td>Desktop</td>\n",
       "      <td>2019-08-03</td>\n",
       "      <td>2021-03-07</td>\n",
       "      <td>2021-03-07</td>\n",
       "      <td>2019-08-03</td>\n",
       "      <td>1.000</td>\n",
       "      <td>1.000</td>\n",
       "      <td>49.990</td>\n",
       "      <td>159.990</td>\n",
       "      <td>[AKTIFSPOR]</td>\n",
       "      <td>2.000</td>\n",
       "      <td>209.980</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                              master_id order_channel last_order_channel  \\\n",
       "0  cc294636-19f0-11eb-8d74-000d3a38a36f   Android App            Offline   \n",
       "1  f431bd5a-ab7b-11e9-a2fc-000d3a38a36f   Android App             Mobile   \n",
       "2  69b69676-1a40-11ea-941b-000d3a38a36f   Android App        Android App   \n",
       "3  1854e56c-491f-11eb-806e-000d3a38a36f   Android App        Android App   \n",
       "4  d6ea1074-f1f5-11e9-9346-000d3a38a36f       Desktop            Desktop   \n",
       "\n",
       "  first_order_date last_order_date last_order_date_online  \\\n",
       "0       2020-10-30      2021-02-26             2021-02-21   \n",
       "1       2017-02-08      2021-02-16             2021-02-16   \n",
       "2       2019-11-27      2020-11-27             2020-11-27   \n",
       "3       2021-01-06      2021-01-17             2021-01-17   \n",
       "4       2019-08-03      2021-03-07             2021-03-07   \n",
       "\n",
       "  last_order_date_offline  order_num_total_ever_online  \\\n",
       "0              2021-02-26                        4.000   \n",
       "1              2020-01-10                       19.000   \n",
       "2              2019-12-01                        3.000   \n",
       "3              2021-01-06                        1.000   \n",
       "4              2019-08-03                        1.000   \n",
       "\n",
       "   order_num_total_ever_offline  customer_value_total_ever_offline  \\\n",
       "0                         1.000                            139.990   \n",
       "1                         2.000                            159.970   \n",
       "2                         2.000                            189.970   \n",
       "3                         1.000                             39.990   \n",
       "4                         1.000                             49.990   \n",
       "\n",
       "   customer_value_total_ever_online       interested_in_categories_12  \\\n",
       "0                           799.380                           [KADIN]   \n",
       "1                          1853.580  [ERKEK, COCUK, KADIN, AKTIFSPOR]   \n",
       "2                           395.350                    [ERKEK, KADIN]   \n",
       "3                            81.980               [AKTIFCOCUK, COCUK]   \n",
       "4                           159.990                       [AKTIFSPOR]   \n",
       "\n",
       "   total_order  total_spend  \n",
       "0        5.000      939.370  \n",
       "1       21.000     2013.550  \n",
       "2        5.000      585.320  \n",
       "3        2.000      121.970  \n",
       "4        2.000      209.980  "
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# 3. Omnichannel müşterilerin hem online'dan hemde offline platformlardan alışveriş yaptığını ifade etmektedir. Herbir müşterinin toplam\n",
    "# alışveriş sayısı ve harcaması için yeni değişkenler oluşturun.\n",
    "df.head(2)\n",
    "#toplam alışveriş sayısı\n",
    "\n",
    "df[\"total_order\"]=df[\"order_num_total_ever_online\"]+df[\"order_num_total_ever_offline\"]\n",
    "df[\"total_spend\"]=df[\"customer_value_total_ever_offline\"]+df[\"customer_value_total_ever_online\"]\n",
    "df.head()\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "76b862fc",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-09-09T07:32:18.094776Z",
     "iopub.status.busy": "2024-09-09T07:32:18.093738Z",
     "iopub.status.idle": "2024-09-09T07:32:18.160146Z",
     "shell.execute_reply": "2024-09-09T07:32:18.158981Z"
    },
    "papermill": {
     "duration": 0.082194,
     "end_time": "2024-09-09T07:32:18.163935",
     "exception": false,
     "start_time": "2024-09-09T07:32:18.081741",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "master_id                                    object\n",
       "order_channel                                object\n",
       "last_order_channel                           object\n",
       "first_order_date                     datetime64[ns]\n",
       "last_order_date                      datetime64[ns]\n",
       "last_order_date_online               datetime64[ns]\n",
       "last_order_date_offline              datetime64[ns]\n",
       "order_num_total_ever_online                 float64\n",
       "order_num_total_ever_offline                float64\n",
       "customer_value_total_ever_offline           float64\n",
       "customer_value_total_ever_online            float64\n",
       "interested_in_categories_12                  object\n",
       "total_order                                 float64\n",
       "total_spend                                 float64\n",
       "dtype: object"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    " # 4. Değişken tiplerini inceleyiniz. Tarih ifade eden değişkenlerin tipini date'e çeviriniz.\n",
    "df.dtypes\n",
    "\n",
    "df[\"first_order_date\"]=pd.to_datetime(df[\"first_order_date\"])\n",
    "df[\"last_order_date\"]=pd.to_datetime(df[\"last_order_date\"])\n",
    "df[\"last_order_date_online\"]=pd.to_datetime(df[\"last_order_date_online\"])\n",
    "df[\"last_order_date_offline\"]=pd.to_datetime(df[\"last_order_date_offline\"])\n",
    "df.dtypes\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "bd54ece3",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-09-09T07:32:18.189166Z",
     "iopub.status.busy": "2024-09-09T07:32:18.187766Z",
     "iopub.status.idle": "2024-09-09T07:32:18.481476Z",
     "shell.execute_reply": "2024-09-09T07:32:18.479935Z"
    },
    "papermill": {
     "duration": 0.308444,
     "end_time": "2024-09-09T07:32:18.484822",
     "exception": false,
     "start_time": "2024-09-09T07:32:18.176378",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "image/png": "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3jzt3LlTBQUFmjZtmqKjo63rAqF8OXTokBo2bHjFi5T+9NNPqlOnjg2pyiYKTDlSWFiohIQExcXFacWKFfLx8dFPP/1kdyyUgE2bNhV57F//+tdSTAK7pKamKi4uTgsXLlRWVpbuvvtuLV++3O5YKGGRkZH66KOPLjuanpGRoc6dO3Om4SUoMOXUiRMntHDhQg0fPtzuKABKUEFBgVasWKF58+ZRYMqhdu3aqUWLFoqLi7OW/fe//1WnTp3UrFkzffTRRzamK1soMICBsrKyFBcXZ13IrlmzZoqOjpafn5/NyQD8GSdOnFDHjh11zz33aNq0aTp+/LjuuusutWzZUosXLy7y/e8qAgoMYJjdu3crIiJC3t7euuWWWyRJu3bt0rlz57RmzRq1adPG5oQA/oy0tDTdcccdioyM1MqVK9WmTRstWrSIOY2/QoEBDNOhQwc1bNhQ77zzjnXrgPz8fPXv31//+c9/tHnzZpsTAvizDh06pA4dOujuu+/WwoULOcP0CigwgGG8vb311VdfqUmTJi7LDxw4oLCwMOXk5NiUDMDVqFmz5hULSk5Ojry8vFyOvJw8efJaRivTuA4MYBhfX18dO3bssgKTlpbGqbWAgWbMmGF3BCNRYAxUnDOLpk2bVopJYIdHH31UMTExmjJlim677TZJUmJiokaMGMGtJMqZBQsWqE6dOurevbskaeTIkXr77bcVGhqqDz74QPXr17c5IUpCnz597I5gJL5CMtBdd93l8jw5OVn5+flq3LixpF++O3V3d1fbtm21fv16OyKiFOXl5WnEiBGaM2eO8vPz5XQ65enpqYEDB2rixIny8vKyOyJKSOPGjTV79mx16tRJ27ZtU5cuXTR9+nStXLlSHh4e+uSTT+yOiBKWnJysypUrq3nz5pKkzz77TPPnz1doaKjGjRsnT09PmxOWHRQYw02bNk0bN2687M7E/fr1U4cOHfTss8/anBClJScnR0eOHJEkNWjQQFWrVrU5EUpa1apV9c0336hevXr65z//qf/+97969913lZKSojvvvFMnTpywOyJKWLt27TRq1ChFRkbqP//5j0JDQ/Xwww9r165d1s098QsKjOGuv/56rVmz5rIb++3fv19du3bV8ePHbUqGkhYdHV2kcfPmzSvlJLhW/P39lZCQoNatW6t169YaPny4nnzySR05ckQtW7bUmTNn7I6IEubn56fk5GQ1aNBAkyZN0vr165WQkKDExET16tVLaWlpdkcsM5gDYziHw3HFf4WdOHFCp0+ftiERSkt8fLzq16+v1q1bi393VAx33323+vfvr9atW+vQoUO69957JUkpKSm68cYb7Q2HUuF0OlVYWChJ+ve//6377rtPklS3bl1uDfMrFBjDPfTQQ+rXr5+mTp1qXdRsx44dGjFihB5++GGb06EkDRw4UB988IGOHj2qfv366YknnnC5Yy3Kn1mzZumFF15QWlqaPv74Y9WuXVuSlJSUxITtciosLEyvvPKKunTpok2bNmn27NmSpKNHjyogIMDmdGULXyEZLicnR88995zmzZunCxcuSJI8PDwUExOj119/XdWqVbM5IUpSbm6uPvnkE82bN09bt25V9+7dFRMTo65du3KhK6Ac2Lt3r6KionTs2DENHz5cY8eOlSQ9/fTT+vnnn/X+++/bnLDsoMCUE2fPnnWZ0ElxKf++//57xcfH691331V+fr5SUlJUvXp1u2OhhHHfK0jS+fPn5e7ursqVK9sdpczgrlDlRLVq1dSiRQu1aNGC8lJBVKpUSW5ubnI6nSooKLA7DkrB7t271aBBA02fPl0nT57UyZMnNW3aNDVo0EDJycl2x0MpycrK0ty5czV69GjryrsHDhxQZmamzcnKFo7AGOjhhx9WfHy8fH19/3CeC9eJKF8u/Qppy5Ytuu+++9SvXz9169aNu9SWQ9z3quLZu3evOnfurBo1aui7775Tamqq/vKXv+iFF17QsWPH9O6779odscxgEq+B/Pz8rPkOHEauOAYNGqTFixerbt26io6O1gcffKA6derYHQulaPfu3S7lRfpljtvIkSMVFhZmYzKUluHDh6tfv36aPHmyy61B7r33Xj3++OM2Jit7OAIDGKJSpUqqV6+eWrdu/bsTdjnqVn4EBARo4cKF6tq1q8vyhIQE9e7dWxkZGTYlQ2m59DowPj4++vrrr/WXv/xF33//vRo3bqzz58/bHbHM4AhMOXHixAmlpqZK+uXy49ddd53NiVDSevfuzZlGFQz3vap4vLy85HA4Llt+6NAhfq7/CkdgDHf27Fk9/fTTevfdd62LH7m7u6t3796aOXMml5cHDPbr+15JUuXKlbnvVTnWv39//fzzz1q6dKlq1aqlvXv3yt3dXT169FDHjh25lcAlKDCG+/vf/65///vfeuutt3T77bdLkrZs2aIhQ4bo7rvvti6CBMBc3Peq4sjOztYjjzyiXbt26cyZMwoODlZ6errCw8P1+eefc5bpJSgwhqtTp44++ugj3XnnnS7LN2zYoJ49e3KzNwAwUGJior7++mudOXNGbdq0UZcuXeyOVOYwB8ZwOTk5V7y8tL+/v3JycmxIBODPKuptQJiwXb4UFhYqPj5en3zyib777ju5ubkpJCREgYGBcjqdzIH7FS4cYbjw8HCNHTvWZWb6uXPnNH78eIWHh9uYDMDV8vPzK9ID5YfT6dQDDzyg/v3768cff1Tz5s3VrFkzff/99+rbt68eeughuyOWOXyFZLh9+/apW7duys3NVcuWLSVJX3/9tapUqaKEhAQ1a9bM5oQAgD8yf/58DR06VJ999pnuuusul3Xr169Xjx499NZbb6l37942JSx7KDDlQE5OjhYtWqRvvvlGktS0aVNFRUXJ29vb5mQAgKLo2rWrOnXqpFGjRl1x/WuvvaZNmzYpISHhGicruygwBrtw4YKaNGmilStXqmnTpnbHAQBcpcDAQK1evVqtWrW64vqvvvpK99xzj9LT069tsDKMOTAGq1y5MldlBIBy4OTJk1c8IeOigIAAnTp16homKvsoMIaLjY3VpEmTrItcAQDMU1BQ4HLPq19zd3fn5/yvcBq14Xbt2qV169ZpzZo1at68+WUXOeI0SwAo+5xOp/r27fubV1fOzc29xonKPgqM4WrUqKHIyEi7YwAA/oQ+ffr84RjOQHLFJF4AAGAc5sAAAADj8BWSgVq3bl3kS0onJyeXchoAAK49CoyBevToYf35/Pnz+te//qXQ0FDr1gHbt29XSkqKBg0aZFNCAABKF3NgDNe/f38FBQXp5Zdfdlk+duxYpaWlad68eTYlAwCg9FBgDOfn56fdu3erUaNGLssPHz6ssLAwZWdn25QMAIDSwyRew3l7eysxMfGy5YmJiapSpYoNiQAAKH3MgTHcsGHDNHDgQCUnJ+uWW26RJO3YsUPz5s3Tiy++aHM6AABKB18hlQNLly7VG2+8oYMHD0r65W7UQ4cOVc+ePW1OBgBA6aDAAAAA4/AVUjmRl5enzMxMFRYWuiyvV6+eTYkAACg9FBjDHT58WNHR0dq6davLcqfTKTc3NxUUFNiUDACA0kOBMVzfvn3l4eGhlStXKigoqMhX6AUAwGTMgTFctWrVlJSUpCZNmtgdBQCAa4brwBguNDRUP/30k90xAAC4pigwhps0aZJGjhypjRs36ueff5bD4XB5AABQHvEVkuEqVfqlg/567guTeAEA5RmTeA23YcMGuyMAAHDNcQSmHNu/f79uvvlmu2MAAFDimANTzpw+fVpvv/22brnlFrVs2dLuOAAAlAoKTDmxefNm9enTR0FBQZoyZYo6deqk7du32x0LAIBSwRwYg6Wnpys+Pl5xcXFyOBzq2bOncnNz9emnnyo0NNTueAAAlBqOwBjq/vvvV+PGjbV3717NmDFDx48f18yZM+2OBQDANcERGEN98cUXGjJkiAYOHKhGjRrZHQcAgGuKIzCG2rJli06fPq22bduqffv2euutt7giLwCgwuA0asOdPXtWS5Ys0bx587Rz504VFBRo2rRpio6Olo+Pj93xAAAoFRSYciQ1NVVxcXFauHChsrKydPfdd2v58uV2xwIAoMRRYMqhgoICrVixQvPmzaPAAADKJQoMAAAwDpN4AQCAcSgwAADAOBQYAABgHAoMAAAwDgUGwJ9y5513atiwYbZmcHNz06effmprhqLq27evevToYXcMwHgUGAAAYBwKDIA/5HQ6lZ+fXyrbLigoUGFhYalsG0D5RYEBKqjc3FwNGTJE/v7+qlKliu644w7t2rVLkrRx40a5ubnpiy++UNu2beXl5aUtW7bo7Nmz6t27t6pXr66goCBNnTr1itt97rnndP3116tatWpq3769Nm7caK2Pj49XjRo1tHz5coWGhsrLy0vHjh37w7zz5s1Ts2bN5OXlpaCgIA0ePNhl/U8//aSHHnpIVatWVaNGjVwu4lhQUKCYmBiFhITI29tbjRs31htvvOHy+otf7UyZMkVBQUGqXbu2YmNjdeHCBWvMjTfeqNdee826VUe9evX09ttvu2wnLS1NPXv2VI0aNVSrVi09+OCD+u677/5w/wAUDwUGqKBGjhypjz/+WAsWLFBycrIaNmyoiIgInTx50hozatQoTZw4UQcPHlSLFi00YsQIbdq0SZ999pnWrFmjjRs3Kjk52WW7gwcP1rZt27R48WLt3btXf/vb39StWzcdPnzYGpOTk6NJkyZp7ty5SklJkb+//+9mnT17tmJjYzVgwADt27dPy5cvV8OGDV3GjB8/Xj179tTevXt17733KioqytqXwsJC3XDDDfrwww914MABjRkzRv/zP/+jpUuXumxjw4YNOnLkiDZs2KAFCxYoPj5e8fHxLmOmTp2qsLAwffXVVxo0aJAGDhyo1NRUSdKFCxcUEREhHx8fffnll0pMTFT16tXVrVs35eXlFe2DAVA0TgAVzpkzZ5yVK1d2Llq0yFqWl5fnDA4Odk6ePNm5YcMGpyTnp59+aq0/ffq009PT07l06VJr2c8//+z09vZ2Dh061Ol0Op3ff/+9093d3fnjjz+6vF/nzp2do0ePdjqdTuf8+fOdkpx79uwpct7g4GDn888//5vrJTlfeOEFl/2T5Pziiy9+8zWxsbHOyMhI63mfPn2c9evXd+bn51vL/va3vzkfffRR63n9+vWdTzzxhPW8sLDQ6e/v75w9e7bT6XQ6Fy5c6GzcuLGzsLDQGpObm+v09vZ2JiQkWO/z4IMPFmGvAfweD3vrEwA7HDlyRBcuXNDtt99uLatcubJuueUWHTx4UO3atZMkhYWFubwmLy9P7du3t5bVqlVLjRs3tp7v27dPBQUFuummm1zeLzc3V7Vr17aee3p6qkWLFkXKmpmZqePHj6tz586/O+7S7VWrVk2+vr7KzMy0ls2aNUvz5s3TsWPHdO7cOeXl5alVq1Yu22jWrJnc3d2t50FBQdq3b99vvo+bm5sCAwOt9/n666/17bffXnYn+PPnz+vIkSNF2l8ARUOBAfCbqlWrVqzxZ86ckbu7u5KSklyKgCRVr17d+rO3t7fc3NyKtE1vb+8ijatcubLLczc3N2ty8OLFi/Xcc89p6tSpCg8Pl4+Pj15//XXt2LGjyNsoypgzZ86obdu2WrRo0WX5rrvuuiLtB4CiocAAFVCDBg3k6empxMRE1a9fX9Iv8zd27dr1m9d0adCggSpXrqwdO3aoXr16kqRTp07p0KFD+utf/ypJat26tQoKCpSZmakOHTqUSFYfHx/deOONWrdune66666r2kZiYqJuu+02DRo0yFpWGkdE2rRpoyVLlsjf31++vr4lvn0A/49JvEAFVK1aNQ0cOFAjRozQ6tWrdeDAAT311FPKyclRTEzMFV9TvXp1xcTEaMSIEVq/fr3279+vvn37qlKl//8xctNNNykqKkq9e/fWJ598oqNHj2rnzp2aMGGCVq1addV5x40bp6lTp+rNN9/U4cOHlZycrJkzZxb59Y0aNdLu3buVkJCgQ4cO6cUXX7TOuCpJUVFRqlOnjh588EF9+eWXOnr0qDZu3KghQ4bohx9+KPH3AyoyjsAAFdTEiRNVWFioJ598UqdPn1ZYWJgSEhJUs2bN33zN66+/rjNnzuj++++Xj4+Pnn32WWVnZ7uMmT9/vl555RU9++yz+vHHH1WnTh3deuutuu+++646a58+fXT+/HlNnz5dzz33nOrUqaNHHnmkyK//+9//rq+++kqPPvqo3Nzc9Nhjj2nQoEH64osvrjrTlVStWlWbN2/WP//5Tz388MM6ffq0rr/+enXu3JkjMkAJc3M6nU67QwAAABQHXyEBAADjUGAA2K569eq/+fjyyy/tjgegDOIrJAC2+/bbb39z3fXXX1/kU6kBVBwUGAAAYBy+QgIAAMahwAAAAONQYAAAgHEoMAAAwDgUGAAAYBwKDAAAMA4FBgAAGOf/AAV140ekyXAyAAAAAElFTkSuQmCC",
      "text/plain": [
       "<Figure size 640x480 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    " # 5. Alışveriş kanallarındaki müşteri sayısının, ortalama alınan ürün sayısının ve ortalama harcamaların dağılımına bakınız.\n",
    "\n",
    "df[\"order_channel\"].value_counts().plot(kind=\"bar\")\n",
    "plt.show()\n",
    "\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "9e5114cb",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-09-09T07:32:18.506914Z",
     "iopub.status.busy": "2024-09-09T07:32:18.506387Z",
     "iopub.status.idle": "2024-09-09T07:32:18.546695Z",
     "shell.execute_reply": "2024-09-09T07:32:18.544931Z"
    },
    "papermill": {
     "duration": 0.05645,
     "end_time": "2024-09-09T07:32:18.551322",
     "exception": false,
     "start_time": "2024-09-09T07:32:18.494872",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>master_id</th>\n",
       "      <th>order_channel</th>\n",
       "      <th>last_order_channel</th>\n",
       "      <th>first_order_date</th>\n",
       "      <th>last_order_date</th>\n",
       "      <th>last_order_date_online</th>\n",
       "      <th>last_order_date_offline</th>\n",
       "      <th>order_num_total_ever_online</th>\n",
       "      <th>order_num_total_ever_offline</th>\n",
       "      <th>customer_value_total_ever_offline</th>\n",
       "      <th>customer_value_total_ever_online</th>\n",
       "      <th>interested_in_categories_12</th>\n",
       "      <th>total_order</th>\n",
       "      <th>total_spend</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>11150</th>\n",
       "      <td>5d1c466a-9cfd-11e9-9897-000d3a38a36f</td>\n",
       "      <td>Android App</td>\n",
       "      <td>Desktop</td>\n",
       "      <td>2013-10-11</td>\n",
       "      <td>2021-04-30</td>\n",
       "      <td>2021-04-30</td>\n",
       "      <td>2020-12-24</td>\n",
       "      <td>200.000</td>\n",
       "      <td>2.000</td>\n",
       "      <td>684.970</td>\n",
       "      <td>45220.130</td>\n",
       "      <td>[AKTIFCOCUK, ERKEK, COCUK, KADIN, AKTIFSPOR]</td>\n",
       "      <td>202.000</td>\n",
       "      <td>45905.100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4315</th>\n",
       "      <td>d5ef8058-a5c6-11e9-a2fc-000d3a38a36f</td>\n",
       "      <td>Android App</td>\n",
       "      <td>Android App</td>\n",
       "      <td>2018-08-06</td>\n",
       "      <td>2021-02-23</td>\n",
       "      <td>2021-02-23</td>\n",
       "      <td>2020-07-06</td>\n",
       "      <td>67.000</td>\n",
       "      <td>1.000</td>\n",
       "      <td>130.490</td>\n",
       "      <td>36687.800</td>\n",
       "      <td>[AKTIFCOCUK, ERKEK, KADIN, AKTIFSPOR]</td>\n",
       "      <td>68.000</td>\n",
       "      <td>36818.290</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7613</th>\n",
       "      <td>73fd19aa-9e37-11e9-9897-000d3a38a36f</td>\n",
       "      <td>Ios App</td>\n",
       "      <td>Offline</td>\n",
       "      <td>2014-01-14</td>\n",
       "      <td>2021-05-18</td>\n",
       "      <td>2021-01-30</td>\n",
       "      <td>2021-05-18</td>\n",
       "      <td>81.000</td>\n",
       "      <td>1.000</td>\n",
       "      <td>1263.760</td>\n",
       "      <td>32654.340</td>\n",
       "      <td>[ERKEK, COCUK, KADIN, AKTIFSPOR]</td>\n",
       "      <td>82.000</td>\n",
       "      <td>33918.100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13880</th>\n",
       "      <td>7137a5c0-7aad-11ea-8f20-000d3a38a36f</td>\n",
       "      <td>Ios App</td>\n",
       "      <td>Offline</td>\n",
       "      <td>2021-03-01</td>\n",
       "      <td>2021-04-13</td>\n",
       "      <td>2021-03-18</td>\n",
       "      <td>2021-04-13</td>\n",
       "      <td>10.000</td>\n",
       "      <td>1.000</td>\n",
       "      <td>538.940</td>\n",
       "      <td>30688.470</td>\n",
       "      <td>[ERKEK, KADIN, AKTIFSPOR]</td>\n",
       "      <td>11.000</td>\n",
       "      <td>31227.410</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9055</th>\n",
       "      <td>47a642fe-975b-11eb-8c2a-000d3a38a36f</td>\n",
       "      <td>Android App</td>\n",
       "      <td>Offline</td>\n",
       "      <td>2021-04-07</td>\n",
       "      <td>2021-04-27</td>\n",
       "      <td>2021-04-07</td>\n",
       "      <td>2021-04-27</td>\n",
       "      <td>1.000</td>\n",
       "      <td>3.000</td>\n",
       "      <td>18119.140</td>\n",
       "      <td>2587.200</td>\n",
       "      <td>[AKTIFSPOR]</td>\n",
       "      <td>4.000</td>\n",
       "      <td>20706.340</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7330</th>\n",
       "      <td>a4d534a2-5b1b-11eb-8dbd-000d3a38a36f</td>\n",
       "      <td>Desktop</td>\n",
       "      <td>Desktop</td>\n",
       "      <td>2020-02-16</td>\n",
       "      <td>2021-04-30</td>\n",
       "      <td>2021-04-30</td>\n",
       "      <td>2020-12-18</td>\n",
       "      <td>66.000</td>\n",
       "      <td>4.000</td>\n",
       "      <td>843.680</td>\n",
       "      <td>17599.890</td>\n",
       "      <td>[ERKEK, KADIN, AKTIFSPOR]</td>\n",
       "      <td>70.000</td>\n",
       "      <td>18443.570</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8068</th>\n",
       "      <td>d696c654-2633-11ea-8e1c-000d3a38a36f</td>\n",
       "      <td>Ios App</td>\n",
       "      <td>Ios App</td>\n",
       "      <td>2017-05-10</td>\n",
       "      <td>2021-04-13</td>\n",
       "      <td>2021-04-13</td>\n",
       "      <td>2019-08-15</td>\n",
       "      <td>69.000</td>\n",
       "      <td>1.000</td>\n",
       "      <td>82.480</td>\n",
       "      <td>16836.090</td>\n",
       "      <td>[AKTIFCOCUK, ERKEK, COCUK, KADIN, AKTIFSPOR]</td>\n",
       "      <td>70.000</td>\n",
       "      <td>16918.570</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>163</th>\n",
       "      <td>fef57ffa-aae6-11e9-a2fc-000d3a38a36f</td>\n",
       "      <td>Mobile</td>\n",
       "      <td>Desktop</td>\n",
       "      <td>2016-11-08</td>\n",
       "      <td>2021-05-12</td>\n",
       "      <td>2021-05-12</td>\n",
       "      <td>2020-07-09</td>\n",
       "      <td>36.000</td>\n",
       "      <td>1.000</td>\n",
       "      <td>180.730</td>\n",
       "      <td>12545.370</td>\n",
       "      <td>[ERKEK, AKTIFSPOR]</td>\n",
       "      <td>37.000</td>\n",
       "      <td>12726.100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7223</th>\n",
       "      <td>cba59206-9dd1-11e9-9897-000d3a38a36f</td>\n",
       "      <td>Android App</td>\n",
       "      <td>Android App</td>\n",
       "      <td>2013-02-21</td>\n",
       "      <td>2021-05-09</td>\n",
       "      <td>2021-05-09</td>\n",
       "      <td>2020-01-25</td>\n",
       "      <td>130.000</td>\n",
       "      <td>1.000</td>\n",
       "      <td>49.990</td>\n",
       "      <td>12232.250</td>\n",
       "      <td>[AKTIFCOCUK, ERKEK, KADIN, AKTIFSPOR]</td>\n",
       "      <td>131.000</td>\n",
       "      <td>12282.240</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18767</th>\n",
       "      <td>fc0ce7a4-9d87-11e9-9897-000d3a38a36f</td>\n",
       "      <td>Desktop</td>\n",
       "      <td>Desktop</td>\n",
       "      <td>2018-11-24</td>\n",
       "      <td>2020-11-11</td>\n",
       "      <td>2020-11-11</td>\n",
       "      <td>2019-12-06</td>\n",
       "      <td>18.000</td>\n",
       "      <td>2.000</td>\n",
       "      <td>64.970</td>\n",
       "      <td>12038.180</td>\n",
       "      <td>[ERKEK, KADIN]</td>\n",
       "      <td>20.000</td>\n",
       "      <td>12103.150</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                  master_id order_channel last_order_channel  \\\n",
       "11150  5d1c466a-9cfd-11e9-9897-000d3a38a36f   Android App            Desktop   \n",
       "4315   d5ef8058-a5c6-11e9-a2fc-000d3a38a36f   Android App        Android App   \n",
       "7613   73fd19aa-9e37-11e9-9897-000d3a38a36f       Ios App            Offline   \n",
       "13880  7137a5c0-7aad-11ea-8f20-000d3a38a36f       Ios App            Offline   \n",
       "9055   47a642fe-975b-11eb-8c2a-000d3a38a36f   Android App            Offline   \n",
       "7330   a4d534a2-5b1b-11eb-8dbd-000d3a38a36f       Desktop            Desktop   \n",
       "8068   d696c654-2633-11ea-8e1c-000d3a38a36f       Ios App            Ios App   \n",
       "163    fef57ffa-aae6-11e9-a2fc-000d3a38a36f        Mobile            Desktop   \n",
       "7223   cba59206-9dd1-11e9-9897-000d3a38a36f   Android App        Android App   \n",
       "18767  fc0ce7a4-9d87-11e9-9897-000d3a38a36f       Desktop            Desktop   \n",
       "\n",
       "      first_order_date last_order_date last_order_date_online  \\\n",
       "11150       2013-10-11      2021-04-30             2021-04-30   \n",
       "4315        2018-08-06      2021-02-23             2021-02-23   \n",
       "7613        2014-01-14      2021-05-18             2021-01-30   \n",
       "13880       2021-03-01      2021-04-13             2021-03-18   \n",
       "9055        2021-04-07      2021-04-27             2021-04-07   \n",
       "7330        2020-02-16      2021-04-30             2021-04-30   \n",
       "8068        2017-05-10      2021-04-13             2021-04-13   \n",
       "163         2016-11-08      2021-05-12             2021-05-12   \n",
       "7223        2013-02-21      2021-05-09             2021-05-09   \n",
       "18767       2018-11-24      2020-11-11             2020-11-11   \n",
       "\n",
       "      last_order_date_offline  order_num_total_ever_online  \\\n",
       "11150              2020-12-24                      200.000   \n",
       "4315               2020-07-06                       67.000   \n",
       "7613               2021-05-18                       81.000   \n",
       "13880              2021-04-13                       10.000   \n",
       "9055               2021-04-27                        1.000   \n",
       "7330               2020-12-18                       66.000   \n",
       "8068               2019-08-15                       69.000   \n",
       "163                2020-07-09                       36.000   \n",
       "7223               2020-01-25                      130.000   \n",
       "18767              2019-12-06                       18.000   \n",
       "\n",
       "       order_num_total_ever_offline  customer_value_total_ever_offline  \\\n",
       "11150                         2.000                            684.970   \n",
       "4315                          1.000                            130.490   \n",
       "7613                          1.000                           1263.760   \n",
       "13880                         1.000                            538.940   \n",
       "9055                          3.000                          18119.140   \n",
       "7330                          4.000                            843.680   \n",
       "8068                          1.000                             82.480   \n",
       "163                           1.000                            180.730   \n",
       "7223                          1.000                             49.990   \n",
       "18767                         2.000                             64.970   \n",
       "\n",
       "       customer_value_total_ever_online  \\\n",
       "11150                         45220.130   \n",
       "4315                          36687.800   \n",
       "7613                          32654.340   \n",
       "13880                         30688.470   \n",
       "9055                           2587.200   \n",
       "7330                          17599.890   \n",
       "8068                          16836.090   \n",
       "163                           12545.370   \n",
       "7223                          12232.250   \n",
       "18767                         12038.180   \n",
       "\n",
       "                        interested_in_categories_12  total_order  total_spend  \n",
       "11150  [AKTIFCOCUK, ERKEK, COCUK, KADIN, AKTIFSPOR]      202.000    45905.100  \n",
       "4315          [AKTIFCOCUK, ERKEK, KADIN, AKTIFSPOR]       68.000    36818.290  \n",
       "7613               [ERKEK, COCUK, KADIN, AKTIFSPOR]       82.000    33918.100  \n",
       "13880                     [ERKEK, KADIN, AKTIFSPOR]       11.000    31227.410  \n",
       "9055                                    [AKTIFSPOR]        4.000    20706.340  \n",
       "7330                      [ERKEK, KADIN, AKTIFSPOR]       70.000    18443.570  \n",
       "8068   [AKTIFCOCUK, ERKEK, COCUK, KADIN, AKTIFSPOR]       70.000    16918.570  \n",
       "163                              [ERKEK, AKTIFSPOR]       37.000    12726.100  \n",
       "7223          [AKTIFCOCUK, ERKEK, KADIN, AKTIFSPOR]      131.000    12282.240  \n",
       "18767                                [ERKEK, KADIN]       20.000    12103.150  "
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# 6. En fazla kazancı getiren ilk 10 müşteriyi sıralayınız.\n",
    "df.sort_values(\"total_spend\",ascending=False)[:10]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "95147fc6",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-09-09T07:32:18.588474Z",
     "iopub.status.busy": "2024-09-09T07:32:18.587482Z",
     "iopub.status.idle": "2024-09-09T07:32:18.621536Z",
     "shell.execute_reply": "2024-09-09T07:32:18.620067Z"
    },
    "papermill": {
     "duration": 0.058764,
     "end_time": "2024-09-09T07:32:18.624701",
     "exception": false,
     "start_time": "2024-09-09T07:32:18.565937",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>master_id</th>\n",
       "      <th>order_channel</th>\n",
       "      <th>last_order_channel</th>\n",
       "      <th>first_order_date</th>\n",
       "      <th>last_order_date</th>\n",
       "      <th>last_order_date_online</th>\n",
       "      <th>last_order_date_offline</th>\n",
       "      <th>order_num_total_ever_online</th>\n",
       "      <th>order_num_total_ever_offline</th>\n",
       "      <th>customer_value_total_ever_offline</th>\n",
       "      <th>customer_value_total_ever_online</th>\n",
       "      <th>interested_in_categories_12</th>\n",
       "      <th>total_order</th>\n",
       "      <th>total_spend</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>11150</th>\n",
       "      <td>5d1c466a-9cfd-11e9-9897-000d3a38a36f</td>\n",
       "      <td>Android App</td>\n",
       "      <td>Desktop</td>\n",
       "      <td>2013-10-11</td>\n",
       "      <td>2021-04-30</td>\n",
       "      <td>2021-04-30</td>\n",
       "      <td>2020-12-24</td>\n",
       "      <td>200.000</td>\n",
       "      <td>2.000</td>\n",
       "      <td>684.970</td>\n",
       "      <td>45220.130</td>\n",
       "      <td>[AKTIFCOCUK, ERKEK, COCUK, KADIN, AKTIFSPOR]</td>\n",
       "      <td>202.000</td>\n",
       "      <td>45905.100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7223</th>\n",
       "      <td>cba59206-9dd1-11e9-9897-000d3a38a36f</td>\n",
       "      <td>Android App</td>\n",
       "      <td>Android App</td>\n",
       "      <td>2013-02-21</td>\n",
       "      <td>2021-05-09</td>\n",
       "      <td>2021-05-09</td>\n",
       "      <td>2020-01-25</td>\n",
       "      <td>130.000</td>\n",
       "      <td>1.000</td>\n",
       "      <td>49.990</td>\n",
       "      <td>12232.250</td>\n",
       "      <td>[AKTIFCOCUK, ERKEK, KADIN, AKTIFSPOR]</td>\n",
       "      <td>131.000</td>\n",
       "      <td>12282.240</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8783</th>\n",
       "      <td>a57f4302-b1a8-11e9-89fa-000d3a38a36f</td>\n",
       "      <td>Android App</td>\n",
       "      <td>Offline</td>\n",
       "      <td>2019-08-07</td>\n",
       "      <td>2020-11-04</td>\n",
       "      <td>2020-09-07</td>\n",
       "      <td>2020-11-04</td>\n",
       "      <td>2.000</td>\n",
       "      <td>109.000</td>\n",
       "      <td>10239.460</td>\n",
       "      <td>143.980</td>\n",
       "      <td>[AKTIFCOCUK, ERKEK, COCUK, KADIN, AKTIFSPOR]</td>\n",
       "      <td>111.000</td>\n",
       "      <td>10383.440</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2619</th>\n",
       "      <td>fdbe8304-a7ab-11e9-a2fc-000d3a38a36f</td>\n",
       "      <td>Android App</td>\n",
       "      <td>Offline</td>\n",
       "      <td>2018-10-18</td>\n",
       "      <td>2020-06-30</td>\n",
       "      <td>2018-10-18</td>\n",
       "      <td>2020-06-30</td>\n",
       "      <td>1.000</td>\n",
       "      <td>87.000</td>\n",
       "      <td>8432.250</td>\n",
       "      <td>139.980</td>\n",
       "      <td>[ERKEK]</td>\n",
       "      <td>88.000</td>\n",
       "      <td>8572.230</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6322</th>\n",
       "      <td>329968c6-a0e2-11e9-a2fc-000d3a38a36f</td>\n",
       "      <td>Ios App</td>\n",
       "      <td>Ios App</td>\n",
       "      <td>2019-02-14</td>\n",
       "      <td>2021-04-05</td>\n",
       "      <td>2021-04-05</td>\n",
       "      <td>2020-02-17</td>\n",
       "      <td>2.000</td>\n",
       "      <td>81.000</td>\n",
       "      <td>3997.550</td>\n",
       "      <td>242.810</td>\n",
       "      <td>[ERKEK]</td>\n",
       "      <td>83.000</td>\n",
       "      <td>4240.360</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7613</th>\n",
       "      <td>73fd19aa-9e37-11e9-9897-000d3a38a36f</td>\n",
       "      <td>Ios App</td>\n",
       "      <td>Offline</td>\n",
       "      <td>2014-01-14</td>\n",
       "      <td>2021-05-18</td>\n",
       "      <td>2021-01-30</td>\n",
       "      <td>2021-05-18</td>\n",
       "      <td>81.000</td>\n",
       "      <td>1.000</td>\n",
       "      <td>1263.760</td>\n",
       "      <td>32654.340</td>\n",
       "      <td>[ERKEK, COCUK, KADIN, AKTIFSPOR]</td>\n",
       "      <td>82.000</td>\n",
       "      <td>33918.100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9347</th>\n",
       "      <td>44d032ee-a0d4-11e9-a2fc-000d3a38a36f</td>\n",
       "      <td>Mobile</td>\n",
       "      <td>Mobile</td>\n",
       "      <td>2019-02-11</td>\n",
       "      <td>2021-02-11</td>\n",
       "      <td>2021-02-11</td>\n",
       "      <td>2020-12-24</td>\n",
       "      <td>3.000</td>\n",
       "      <td>74.000</td>\n",
       "      <td>4640.770</td>\n",
       "      <td>543.280</td>\n",
       "      <td>[KADIN, AKTIFSPOR]</td>\n",
       "      <td>77.000</td>\n",
       "      <td>5184.050</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10954</th>\n",
       "      <td>b27e241a-a901-11e9-a2fc-000d3a38a36f</td>\n",
       "      <td>Mobile</td>\n",
       "      <td>Mobile</td>\n",
       "      <td>2015-09-12</td>\n",
       "      <td>2021-04-01</td>\n",
       "      <td>2021-04-01</td>\n",
       "      <td>2019-10-08</td>\n",
       "      <td>72.000</td>\n",
       "      <td>3.000</td>\n",
       "      <td>292.930</td>\n",
       "      <td>5004.950</td>\n",
       "      <td>[AKTIFCOCUK, ERKEK, KADIN, AKTIFSPOR]</td>\n",
       "      <td>75.000</td>\n",
       "      <td>5297.880</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8068</th>\n",
       "      <td>d696c654-2633-11ea-8e1c-000d3a38a36f</td>\n",
       "      <td>Ios App</td>\n",
       "      <td>Ios App</td>\n",
       "      <td>2017-05-10</td>\n",
       "      <td>2021-04-13</td>\n",
       "      <td>2021-04-13</td>\n",
       "      <td>2019-08-15</td>\n",
       "      <td>69.000</td>\n",
       "      <td>1.000</td>\n",
       "      <td>82.480</td>\n",
       "      <td>16836.090</td>\n",
       "      <td>[AKTIFCOCUK, ERKEK, COCUK, KADIN, AKTIFSPOR]</td>\n",
       "      <td>70.000</td>\n",
       "      <td>16918.570</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7330</th>\n",
       "      <td>a4d534a2-5b1b-11eb-8dbd-000d3a38a36f</td>\n",
       "      <td>Desktop</td>\n",
       "      <td>Desktop</td>\n",
       "      <td>2020-02-16</td>\n",
       "      <td>2021-04-30</td>\n",
       "      <td>2021-04-30</td>\n",
       "      <td>2020-12-18</td>\n",
       "      <td>66.000</td>\n",
       "      <td>4.000</td>\n",
       "      <td>843.680</td>\n",
       "      <td>17599.890</td>\n",
       "      <td>[ERKEK, KADIN, AKTIFSPOR]</td>\n",
       "      <td>70.000</td>\n",
       "      <td>18443.570</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                  master_id order_channel last_order_channel  \\\n",
       "11150  5d1c466a-9cfd-11e9-9897-000d3a38a36f   Android App            Desktop   \n",
       "7223   cba59206-9dd1-11e9-9897-000d3a38a36f   Android App        Android App   \n",
       "8783   a57f4302-b1a8-11e9-89fa-000d3a38a36f   Android App            Offline   \n",
       "2619   fdbe8304-a7ab-11e9-a2fc-000d3a38a36f   Android App            Offline   \n",
       "6322   329968c6-a0e2-11e9-a2fc-000d3a38a36f       Ios App            Ios App   \n",
       "7613   73fd19aa-9e37-11e9-9897-000d3a38a36f       Ios App            Offline   \n",
       "9347   44d032ee-a0d4-11e9-a2fc-000d3a38a36f        Mobile             Mobile   \n",
       "10954  b27e241a-a901-11e9-a2fc-000d3a38a36f        Mobile             Mobile   \n",
       "8068   d696c654-2633-11ea-8e1c-000d3a38a36f       Ios App            Ios App   \n",
       "7330   a4d534a2-5b1b-11eb-8dbd-000d3a38a36f       Desktop            Desktop   \n",
       "\n",
       "      first_order_date last_order_date last_order_date_online  \\\n",
       "11150       2013-10-11      2021-04-30             2021-04-30   \n",
       "7223        2013-02-21      2021-05-09             2021-05-09   \n",
       "8783        2019-08-07      2020-11-04             2020-09-07   \n",
       "2619        2018-10-18      2020-06-30             2018-10-18   \n",
       "6322        2019-02-14      2021-04-05             2021-04-05   \n",
       "7613        2014-01-14      2021-05-18             2021-01-30   \n",
       "9347        2019-02-11      2021-02-11             2021-02-11   \n",
       "10954       2015-09-12      2021-04-01             2021-04-01   \n",
       "8068        2017-05-10      2021-04-13             2021-04-13   \n",
       "7330        2020-02-16      2021-04-30             2021-04-30   \n",
       "\n",
       "      last_order_date_offline  order_num_total_ever_online  \\\n",
       "11150              2020-12-24                      200.000   \n",
       "7223               2020-01-25                      130.000   \n",
       "8783               2020-11-04                        2.000   \n",
       "2619               2020-06-30                        1.000   \n",
       "6322               2020-02-17                        2.000   \n",
       "7613               2021-05-18                       81.000   \n",
       "9347               2020-12-24                        3.000   \n",
       "10954              2019-10-08                       72.000   \n",
       "8068               2019-08-15                       69.000   \n",
       "7330               2020-12-18                       66.000   \n",
       "\n",
       "       order_num_total_ever_offline  customer_value_total_ever_offline  \\\n",
       "11150                         2.000                            684.970   \n",
       "7223                          1.000                             49.990   \n",
       "8783                        109.000                          10239.460   \n",
       "2619                         87.000                           8432.250   \n",
       "6322                         81.000                           3997.550   \n",
       "7613                          1.000                           1263.760   \n",
       "9347                         74.000                           4640.770   \n",
       "10954                         3.000                            292.930   \n",
       "8068                          1.000                             82.480   \n",
       "7330                          4.000                            843.680   \n",
       "\n",
       "       customer_value_total_ever_online  \\\n",
       "11150                         45220.130   \n",
       "7223                          12232.250   \n",
       "8783                            143.980   \n",
       "2619                            139.980   \n",
       "6322                            242.810   \n",
       "7613                          32654.340   \n",
       "9347                            543.280   \n",
       "10954                          5004.950   \n",
       "8068                          16836.090   \n",
       "7330                          17599.890   \n",
       "\n",
       "                        interested_in_categories_12  total_order  total_spend  \n",
       "11150  [AKTIFCOCUK, ERKEK, COCUK, KADIN, AKTIFSPOR]      202.000    45905.100  \n",
       "7223          [AKTIFCOCUK, ERKEK, KADIN, AKTIFSPOR]      131.000    12282.240  \n",
       "8783   [AKTIFCOCUK, ERKEK, COCUK, KADIN, AKTIFSPOR]      111.000    10383.440  \n",
       "2619                                        [ERKEK]       88.000     8572.230  \n",
       "6322                                        [ERKEK]       83.000     4240.360  \n",
       "7613               [ERKEK, COCUK, KADIN, AKTIFSPOR]       82.000    33918.100  \n",
       "9347                             [KADIN, AKTIFSPOR]       77.000     5184.050  \n",
       "10954         [AKTIFCOCUK, ERKEK, KADIN, AKTIFSPOR]       75.000     5297.880  \n",
       "8068   [AKTIFCOCUK, ERKEK, COCUK, KADIN, AKTIFSPOR]       70.000    16918.570  \n",
       "7330                      [ERKEK, KADIN, AKTIFSPOR]       70.000    18443.570  "
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# 7. En fazla siparişi veren ilk 10 müşteriyi sıralayınız.\n",
    "df.sort_values(\"total_order\",ascending=False)[:10]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "9d3e42e3",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-09-09T07:32:18.648689Z",
     "iopub.status.busy": "2024-09-09T07:32:18.648219Z",
     "iopub.status.idle": "2024-09-09T07:32:18.658558Z",
     "shell.execute_reply": "2024-09-09T07:32:18.657059Z"
    },
    "papermill": {
     "duration": 0.025983,
     "end_time": "2024-09-09T07:32:18.661532",
     "exception": false,
     "start_time": "2024-09-09T07:32:18.635549",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "def general_inf(df):\n",
    "    print(\"###Variables###\")\n",
    "    print(df.head(10))\n",
    "    print(\"\\n\")\n",
    "    print(\"###All Columns###\")\n",
    "    print(df.columns)\n",
    "    print(\"\\n\")\n",
    "    print(\"###Size###\")\n",
    "    print(df.shape)\n",
    "    print(\"\\n\")\n",
    "    print(\"###Describe###\")\n",
    "    print(df.describe().T)\n",
    "    print(\"\\n\")\n",
    "    print(\"###Is There Any Sum Variable?###\")\n",
    "    print(df.isnull().sum())\n",
    "    print(\"\\n\")\n",
    "    print(\"###Types###\")\n",
    "    print(df.dtypes)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "064065b3",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-09-09T07:32:18.686795Z",
     "iopub.status.busy": "2024-09-09T07:32:18.686285Z",
     "iopub.status.idle": "2024-09-09T07:32:18.696833Z",
     "shell.execute_reply": "2024-09-09T07:32:18.695292Z"
    },
    "papermill": {
     "duration": 0.026881,
     "end_time": "2024-09-09T07:32:18.699499",
     "exception": false,
     "start_time": "2024-09-09T07:32:18.672618",
     "status": "completed"
    },
    "scrolled": true,
    "tags": []
   },
   "outputs": [],
   "source": [
    "# 8. Veri ön hazırlık sürecini fonksiyonlaştırınız.\n",
    "def hold_variables(df):\n",
    "    \n",
    "    df[\"total_order\"]=df[\"order_num_total_ever_online\"]+df[\"order_num_total_ever_offline\"]\n",
    "    df[\"total_spend\"]=df[\"customer_value_total_ever_offline\"]+df[\"customer_value_total_ever_online\"]\n",
    "    df[\"first_order_date\"]=pd.to_datetime(df[\"first_order_date\"])\n",
    "    df[\"last_order_date\"]=pd.to_datetime(df[\"last_order_date\"])\n",
    "    df[\"last_order_date_online\"]=pd.to_datetime(df[\"last_order_date_online\"])\n",
    "    df[\"last_order_date_offline\"]=pd.to_datetime(df[\"last_order_date_offline\"])\n",
    "    \n",
    "    df[\"order_channel\"].value_counts().plot(kind=\"bar\")\n",
    "    plt.show()\n",
    "    print(\"###Top 10 people who spend the most###\")\n",
    "    print(df.sort_values(\"total_spend\",ascending=False)[:10])\n",
    "    print(\"\\n\")\n",
    "    print(\"###Top 10 people with the most orders###\")\n",
    "    print(df.sort_values(\"total_order\",ascending=False)[:10])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "388fcbed",
   "metadata": {
    "collapsed": true,
    "execution": {
     "iopub.execute_input": "2024-09-09T07:32:18.724119Z",
     "iopub.status.busy": "2024-09-09T07:32:18.723020Z",
     "iopub.status.idle": "2024-09-09T07:32:18.798519Z",
     "shell.execute_reply": "2024-09-09T07:32:18.797025Z"
    },
    "jupyter": {
     "outputs_hidden": true
    },
    "papermill": {
     "duration": 0.092405,
     "end_time": "2024-09-09T07:32:18.802774",
     "exception": false,
     "start_time": "2024-09-09T07:32:18.710369",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "###Variables###\n",
      "                              master_id order_channel last_order_channel  \\\n",
      "0  cc294636-19f0-11eb-8d74-000d3a38a36f   Android App            Offline   \n",
      "1  f431bd5a-ab7b-11e9-a2fc-000d3a38a36f   Android App             Mobile   \n",
      "2  69b69676-1a40-11ea-941b-000d3a38a36f   Android App        Android App   \n",
      "3  1854e56c-491f-11eb-806e-000d3a38a36f   Android App        Android App   \n",
      "4  d6ea1074-f1f5-11e9-9346-000d3a38a36f       Desktop            Desktop   \n",
      "5  e585280e-aae1-11e9-a2fc-000d3a38a36f       Desktop            Offline   \n",
      "6  c445e4ee-6242-11ea-9d1a-000d3a38a36f   Android App        Android App   \n",
      "7  3f1b4dc8-8a7d-11ea-8ec0-000d3a38a36f        Mobile            Offline   \n",
      "8  cfbda69e-5b4f-11ea-aca7-000d3a38a36f   Android App        Android App   \n",
      "9  1143f032-440d-11ea-8b43-000d3a38a36f        Mobile             Mobile   \n",
      "\n",
      "  first_order_date last_order_date last_order_date_online  \\\n",
      "0       2020-10-30      2021-02-26             2021-02-21   \n",
      "1       2017-02-08      2021-02-16             2021-02-16   \n",
      "2       2019-11-27      2020-11-27             2020-11-27   \n",
      "3       2021-01-06      2021-01-17             2021-01-17   \n",
      "4       2019-08-03      2021-03-07             2021-03-07   \n",
      "5       2018-11-18      2021-03-13             2018-11-18   \n",
      "6       2020-03-04      2020-10-18             2020-10-18   \n",
      "7       2020-05-15      2020-08-12             2020-05-15   \n",
      "8       2020-01-23      2021-03-07             2021-03-07   \n",
      "9       2019-07-30      2020-10-04             2020-10-04   \n",
      "\n",
      "  last_order_date_offline  order_num_total_ever_online  \\\n",
      "0              2021-02-26                        4.000   \n",
      "1              2020-01-10                       19.000   \n",
      "2              2019-12-01                        3.000   \n",
      "3              2021-01-06                        1.000   \n",
      "4              2019-08-03                        1.000   \n",
      "5              2021-03-13                        1.000   \n",
      "6              2020-03-04                        3.000   \n",
      "7              2020-08-12                        1.000   \n",
      "8              2020-01-25                        3.000   \n",
      "9              2019-07-30                        1.000   \n",
      "\n",
      "   order_num_total_ever_offline  customer_value_total_ever_offline  \\\n",
      "0                         1.000                            139.990   \n",
      "1                         2.000                            159.970   \n",
      "2                         2.000                            189.970   \n",
      "3                         1.000                             39.990   \n",
      "4                         1.000                             49.990   \n",
      "5                         2.000                            150.870   \n",
      "6                         1.000                             59.990   \n",
      "7                         1.000                             49.990   \n",
      "8                         2.000                            120.480   \n",
      "9                         1.000                             69.980   \n",
      "\n",
      "   customer_value_total_ever_online       interested_in_categories_12  \\\n",
      "0                           799.380                           [KADIN]   \n",
      "1                          1853.580  [ERKEK, COCUK, KADIN, AKTIFSPOR]   \n",
      "2                           395.350                    [ERKEK, KADIN]   \n",
      "3                            81.980               [AKTIFCOCUK, COCUK]   \n",
      "4                           159.990                       [AKTIFSPOR]   \n",
      "5                            49.990                           [KADIN]   \n",
      "6                           315.940                       [AKTIFSPOR]   \n",
      "7                           113.640                           [COCUK]   \n",
      "8                           934.210             [ERKEK, COCUK, KADIN]   \n",
      "9                            95.980                [KADIN, AKTIFSPOR]   \n",
      "\n",
      "   total_order  total_spend  \n",
      "0        5.000      939.370  \n",
      "1       21.000     2013.550  \n",
      "2        5.000      585.320  \n",
      "3        2.000      121.970  \n",
      "4        2.000      209.980  \n",
      "5        3.000      200.860  \n",
      "6        4.000      375.930  \n",
      "7        2.000      163.630  \n",
      "8        5.000     1054.690  \n",
      "9        2.000      165.960  \n",
      "\n",
      "\n",
      "###All Columns###\n",
      "Index(['master_id', 'order_channel', 'last_order_channel', 'first_order_date',\n",
      "       'last_order_date', 'last_order_date_online', 'last_order_date_offline',\n",
      "       'order_num_total_ever_online', 'order_num_total_ever_offline',\n",
      "       'customer_value_total_ever_offline', 'customer_value_total_ever_online',\n",
      "       'interested_in_categories_12', 'total_order', 'total_spend'],\n",
      "      dtype='object')\n",
      "\n",
      "\n",
      "###Size###\n",
      "(19945, 14)\n",
      "\n",
      "\n",
      "###Describe###\n",
      "                                      count                           mean  \\\n",
      "first_order_date                      19945  2019-03-22 16:43:55.246929152   \n",
      "last_order_date                       19945  2021-01-17 12:59:57.653547264   \n",
      "last_order_date_online                19945  2020-08-10 01:08:52.644773376   \n",
      "last_order_date_offline               19945  2020-05-17 12:07:24.021058048   \n",
      "order_num_total_ever_online       19945.000                          3.111   \n",
      "order_num_total_ever_offline      19945.000                          1.914   \n",
      "customer_value_total_ever_offline 19945.000                        253.923   \n",
      "customer_value_total_ever_online  19945.000                        497.322   \n",
      "total_order                       19945.000                          5.025   \n",
      "total_spend                       19945.000                        751.244   \n",
      "\n",
      "                                                   min                  25%  \\\n",
      "first_order_date                   2013-01-14 00:00:00  2019-02-16 00:00:00   \n",
      "last_order_date                    2020-05-30 00:00:00  2020-11-11 00:00:00   \n",
      "last_order_date_online             2014-02-24 00:00:00  2020-06-18 00:00:00   \n",
      "last_order_date_offline            2019-01-22 00:00:00  2019-11-04 00:00:00   \n",
      "order_num_total_ever_online                      1.000                1.000   \n",
      "order_num_total_ever_offline                     1.000                1.000   \n",
      "customer_value_total_ever_offline               10.000               99.990   \n",
      "customer_value_total_ever_online                12.990              149.980   \n",
      "total_order                                      2.000                3.000   \n",
      "total_spend                                     44.980              339.980   \n",
      "\n",
      "                                                   50%                  75%  \\\n",
      "first_order_date                   2019-08-20 00:00:00  2020-01-01 00:00:00   \n",
      "last_order_date                    2021-02-10 00:00:00  2021-04-19 00:00:00   \n",
      "last_order_date_online             2020-12-14 00:00:00  2021-04-05 00:00:00   \n",
      "last_order_date_offline            2020-06-22 00:00:00  2020-12-25 00:00:00   \n",
      "order_num_total_ever_online                      2.000                4.000   \n",
      "order_num_total_ever_offline                     1.000                2.000   \n",
      "customer_value_total_ever_offline              179.980              319.970   \n",
      "customer_value_total_ever_online               286.460              578.440   \n",
      "total_order                                      4.000                6.000   \n",
      "total_spend                                    545.270              897.780   \n",
      "\n",
      "                                                   max     std  \n",
      "first_order_date                   2021-05-27 00:00:00     NaN  \n",
      "last_order_date                    2021-05-30 00:00:00     NaN  \n",
      "last_order_date_online             2021-05-30 00:00:00     NaN  \n",
      "last_order_date_offline            2021-05-28 00:00:00     NaN  \n",
      "order_num_total_ever_online                    200.000   4.226  \n",
      "order_num_total_ever_offline                   109.000   2.063  \n",
      "customer_value_total_ever_offline            18119.140 301.533  \n",
      "customer_value_total_ever_online             45220.130 832.602  \n",
      "total_order                                    202.000   4.743  \n",
      "total_spend                                  45905.100 895.402  \n",
      "\n",
      "\n",
      "###Is There Any Sum Variable?###\n",
      "master_id                            0\n",
      "order_channel                        0\n",
      "last_order_channel                   0\n",
      "first_order_date                     0\n",
      "last_order_date                      0\n",
      "last_order_date_online               0\n",
      "last_order_date_offline              0\n",
      "order_num_total_ever_online          0\n",
      "order_num_total_ever_offline         0\n",
      "customer_value_total_ever_offline    0\n",
      "customer_value_total_ever_online     0\n",
      "interested_in_categories_12          0\n",
      "total_order                          0\n",
      "total_spend                          0\n",
      "dtype: int64\n",
      "\n",
      "\n",
      "###Types###\n",
      "master_id                                    object\n",
      "order_channel                                object\n",
      "last_order_channel                           object\n",
      "first_order_date                     datetime64[ns]\n",
      "last_order_date                      datetime64[ns]\n",
      "last_order_date_online               datetime64[ns]\n",
      "last_order_date_offline              datetime64[ns]\n",
      "order_num_total_ever_online                 float64\n",
      "order_num_total_ever_offline                float64\n",
      "customer_value_total_ever_offline           float64\n",
      "customer_value_total_ever_online            float64\n",
      "interested_in_categories_12                  object\n",
      "total_order                                 float64\n",
      "total_spend                                 float64\n",
      "dtype: object\n"
     ]
    }
   ],
   "source": [
    "general_inf(df)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "37ec459b",
   "metadata": {
    "collapsed": true,
    "execution": {
     "iopub.execute_input": "2024-09-09T07:32:18.829471Z",
     "iopub.status.busy": "2024-09-09T07:32:18.828964Z",
     "iopub.status.idle": "2024-09-09T07:32:19.161137Z",
     "shell.execute_reply": "2024-09-09T07:32:19.159917Z"
    },
    "jupyter": {
     "outputs_hidden": true
    },
    "papermill": {
     "duration": 0.350328,
     "end_time": "2024-09-09T07:32:19.166025",
     "exception": false,
     "start_time": "2024-09-09T07:32:18.815697",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "image/png": "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3jzt3LlTBQUFmjZtmqKjo63rAqF8OXTokBo2bHjFi5T+9NNPqlOnjg2pyiYKTDlSWFiohIQExcXFacWKFfLx8dFPP/1kdyyUgE2bNhV57F//+tdSTAK7pKamKi4uTgsXLlRWVpbuvvtuLV++3O5YKGGRkZH66KOPLjuanpGRoc6dO3Om4SUoMOXUiRMntHDhQg0fPtzuKABKUEFBgVasWKF58+ZRYMqhdu3aqUWLFoqLi7OW/fe//1WnTp3UrFkzffTRRzamK1soMICBsrKyFBcXZ13IrlmzZoqOjpafn5/NyQD8GSdOnFDHjh11zz33aNq0aTp+/LjuuusutWzZUosXLy7y/e8qAgoMYJjdu3crIiJC3t7euuWWWyRJu3bt0rlz57RmzRq1adPG5oQA/oy0tDTdcccdioyM1MqVK9WmTRstWrSIOY2/QoEBDNOhQwc1bNhQ77zzjnXrgPz8fPXv31//+c9/tHnzZpsTAvizDh06pA4dOujuu+/WwoULOcP0CigwgGG8vb311VdfqUmTJi7LDxw4oLCwMOXk5NiUDMDVqFmz5hULSk5Ojry8vFyOvJw8efJaRivTuA4MYBhfX18dO3bssgKTlpbGqbWAgWbMmGF3BCNRYAxUnDOLpk2bVopJYIdHH31UMTExmjJlim677TZJUmJiokaMGMGtJMqZBQsWqE6dOurevbskaeTIkXr77bcVGhqqDz74QPXr17c5IUpCnz597I5gJL5CMtBdd93l8jw5OVn5+flq3LixpF++O3V3d1fbtm21fv16OyKiFOXl5WnEiBGaM2eO8vPz5XQ65enpqYEDB2rixIny8vKyOyJKSOPGjTV79mx16tRJ27ZtU5cuXTR9+nStXLlSHh4e+uSTT+yOiBKWnJysypUrq3nz5pKkzz77TPPnz1doaKjGjRsnT09PmxOWHRQYw02bNk0bN2687M7E/fr1U4cOHfTss8/anBClJScnR0eOHJEkNWjQQFWrVrU5EUpa1apV9c0336hevXr65z//qf/+97969913lZKSojvvvFMnTpywOyJKWLt27TRq1ChFRkbqP//5j0JDQ/Xwww9r165d1s098QsKjOGuv/56rVmz5rIb++3fv19du3bV8ePHbUqGkhYdHV2kcfPmzSvlJLhW/P39lZCQoNatW6t169YaPny4nnzySR05ckQtW7bUmTNn7I6IEubn56fk5GQ1aNBAkyZN0vr165WQkKDExET16tVLaWlpdkcsM5gDYziHw3HFf4WdOHFCp0+ftiERSkt8fLzq16+v1q1bi393VAx33323+vfvr9atW+vQoUO69957JUkpKSm68cYb7Q2HUuF0OlVYWChJ+ve//6377rtPklS3bl1uDfMrFBjDPfTQQ+rXr5+mTp1qXdRsx44dGjFihB5++GGb06EkDRw4UB988IGOHj2qfv366YknnnC5Yy3Kn1mzZumFF15QWlqaPv74Y9WuXVuSlJSUxITtciosLEyvvPKKunTpok2bNmn27NmSpKNHjyogIMDmdGULXyEZLicnR88995zmzZunCxcuSJI8PDwUExOj119/XdWqVbM5IUpSbm6uPvnkE82bN09bt25V9+7dFRMTo65du3KhK6Ac2Lt3r6KionTs2DENHz5cY8eOlSQ9/fTT+vnnn/X+++/bnLDsoMCUE2fPnnWZ0ElxKf++//57xcfH691331V+fr5SUlJUvXp1u2OhhHHfK0jS+fPn5e7ursqVK9sdpczgrlDlRLVq1dSiRQu1aNGC8lJBVKpUSW5ubnI6nSooKLA7DkrB7t271aBBA02fPl0nT57UyZMnNW3aNDVo0EDJycl2x0MpycrK0ty5czV69GjryrsHDhxQZmamzcnKFo7AGOjhhx9WfHy8fH19/3CeC9eJKF8u/Qppy5Ytuu+++9SvXz9169aNu9SWQ9z3quLZu3evOnfurBo1aui7775Tamqq/vKXv+iFF17QsWPH9O6779odscxgEq+B/Pz8rPkOHEauOAYNGqTFixerbt26io6O1gcffKA6derYHQulaPfu3S7lRfpljtvIkSMVFhZmYzKUluHDh6tfv36aPHmyy61B7r33Xj3++OM2Jit7OAIDGKJSpUqqV6+eWrdu/bsTdjnqVn4EBARo4cKF6tq1q8vyhIQE9e7dWxkZGTYlQ2m59DowPj4++vrrr/WXv/xF33//vRo3bqzz58/bHbHM4AhMOXHixAmlpqZK+uXy49ddd53NiVDSevfuzZlGFQz3vap4vLy85HA4Llt+6NAhfq7/CkdgDHf27Fk9/fTTevfdd62LH7m7u6t3796aOXMml5cHDPbr+15JUuXKlbnvVTnWv39//fzzz1q6dKlq1aqlvXv3yt3dXT169FDHjh25lcAlKDCG+/vf/65///vfeuutt3T77bdLkrZs2aIhQ4bo7rvvti6CBMBc3Peq4sjOztYjjzyiXbt26cyZMwoODlZ6errCw8P1+eefc5bpJSgwhqtTp44++ugj3XnnnS7LN2zYoJ49e3KzNwAwUGJior7++mudOXNGbdq0UZcuXeyOVOYwB8ZwOTk5V7y8tL+/v3JycmxIBODPKuptQJiwXb4UFhYqPj5en3zyib777ju5ubkpJCREgYGBcjqdzIH7FS4cYbjw8HCNHTvWZWb6uXPnNH78eIWHh9uYDMDV8vPzK9ID5YfT6dQDDzyg/v3768cff1Tz5s3VrFkzff/99+rbt68eeughuyOWOXyFZLh9+/apW7duys3NVcuWLSVJX3/9tapUqaKEhAQ1a9bM5oQAgD8yf/58DR06VJ999pnuuusul3Xr169Xjx499NZbb6l37942JSx7KDDlQE5OjhYtWqRvvvlGktS0aVNFRUXJ29vb5mQAgKLo2rWrOnXqpFGjRl1x/WuvvaZNmzYpISHhGicruygwBrtw4YKaNGmilStXqmnTpnbHAQBcpcDAQK1evVqtWrW64vqvvvpK99xzj9LT069tsDKMOTAGq1y5MldlBIBy4OTJk1c8IeOigIAAnTp16homKvsoMIaLjY3VpEmTrItcAQDMU1BQ4HLPq19zd3fn5/yvcBq14Xbt2qV169ZpzZo1at68+WUXOeI0SwAo+5xOp/r27fubV1fOzc29xonKPgqM4WrUqKHIyEi7YwAA/oQ+ffr84RjOQHLFJF4AAGAc5sAAAADj8BWSgVq3bl3kS0onJyeXchoAAK49CoyBevToYf35/Pnz+te//qXQ0FDr1gHbt29XSkqKBg0aZFNCAABKF3NgDNe/f38FBQXp5Zdfdlk+duxYpaWlad68eTYlAwCg9FBgDOfn56fdu3erUaNGLssPHz6ssLAwZWdn25QMAIDSwyRew3l7eysxMfGy5YmJiapSpYoNiQAAKH3MgTHcsGHDNHDgQCUnJ+uWW26RJO3YsUPz5s3Tiy++aHM6AABKB18hlQNLly7VG2+8oYMHD0r65W7UQ4cOVc+ePW1OBgBA6aDAAAAA4/AVUjmRl5enzMxMFRYWuiyvV6+eTYkAACg9FBjDHT58WNHR0dq6davLcqfTKTc3NxUUFNiUDACA0kOBMVzfvn3l4eGhlStXKigoqMhX6AUAwGTMgTFctWrVlJSUpCZNmtgdBQCAa4brwBguNDRUP/30k90xAAC4pigwhps0aZJGjhypjRs36ueff5bD4XB5AABQHvEVkuEqVfqlg/567guTeAEA5RmTeA23YcMGuyMAAHDNcQSmHNu/f79uvvlmu2MAAFDimANTzpw+fVpvv/22brnlFrVs2dLuOAAAlAoKTDmxefNm9enTR0FBQZoyZYo6deqk7du32x0LAIBSwRwYg6Wnpys+Pl5xcXFyOBzq2bOncnNz9emnnyo0NNTueAAAlBqOwBjq/vvvV+PGjbV3717NmDFDx48f18yZM+2OBQDANcERGEN98cUXGjJkiAYOHKhGjRrZHQcAgGuKIzCG2rJli06fPq22bduqffv2euutt7giLwCgwuA0asOdPXtWS5Ys0bx587Rz504VFBRo2rRpio6Olo+Pj93xAAAoFRSYciQ1NVVxcXFauHChsrKydPfdd2v58uV2xwIAoMRRYMqhgoICrVixQvPmzaPAAADKJQoMAAAwDpN4AQCAcSgwAADAOBQYAABgHAoMAAAwDgUGwJ9y5513atiwYbZmcHNz06effmprhqLq27evevToYXcMwHgUGAAAYBwKDIA/5HQ6lZ+fXyrbLigoUGFhYalsG0D5RYEBKqjc3FwNGTJE/v7+qlKliu644w7t2rVLkrRx40a5ubnpiy++UNu2beXl5aUtW7bo7Nmz6t27t6pXr66goCBNnTr1itt97rnndP3116tatWpq3769Nm7caK2Pj49XjRo1tHz5coWGhsrLy0vHjh37w7zz5s1Ts2bN5OXlpaCgIA0ePNhl/U8//aSHHnpIVatWVaNGjVwu4lhQUKCYmBiFhITI29tbjRs31htvvOHy+otf7UyZMkVBQUGqXbu2YmNjdeHCBWvMjTfeqNdee826VUe9evX09ttvu2wnLS1NPXv2VI0aNVSrVi09+OCD+u677/5w/wAUDwUGqKBGjhypjz/+WAsWLFBycrIaNmyoiIgInTx50hozatQoTZw4UQcPHlSLFi00YsQIbdq0SZ999pnWrFmjjRs3Kjk52WW7gwcP1rZt27R48WLt3btXf/vb39StWzcdPnzYGpOTk6NJkyZp7ty5SklJkb+//+9mnT17tmJjYzVgwADt27dPy5cvV8OGDV3GjB8/Xj179tTevXt17733KioqytqXwsJC3XDDDfrwww914MABjRkzRv/zP/+jpUuXumxjw4YNOnLkiDZs2KAFCxYoPj5e8fHxLmOmTp2qsLAwffXVVxo0aJAGDhyo1NRUSdKFCxcUEREhHx8fffnll0pMTFT16tXVrVs35eXlFe2DAVA0TgAVzpkzZ5yVK1d2Llq0yFqWl5fnDA4Odk6ePNm5YcMGpyTnp59+aq0/ffq009PT07l06VJr2c8//+z09vZ2Dh061Ol0Op3ff/+9093d3fnjjz+6vF/nzp2do0ePdjqdTuf8+fOdkpx79uwpct7g4GDn888//5vrJTlfeOEFl/2T5Pziiy9+8zWxsbHOyMhI63mfPn2c9evXd+bn51vL/va3vzkfffRR63n9+vWdTzzxhPW8sLDQ6e/v75w9e7bT6XQ6Fy5c6GzcuLGzsLDQGpObm+v09vZ2JiQkWO/z4IMPFmGvAfweD3vrEwA7HDlyRBcuXNDtt99uLatcubJuueUWHTx4UO3atZMkhYWFubwmLy9P7du3t5bVqlVLjRs3tp7v27dPBQUFuummm1zeLzc3V7Vr17aee3p6qkWLFkXKmpmZqePHj6tz586/O+7S7VWrVk2+vr7KzMy0ls2aNUvz5s3TsWPHdO7cOeXl5alVq1Yu22jWrJnc3d2t50FBQdq3b99vvo+bm5sCAwOt9/n666/17bffXnYn+PPnz+vIkSNF2l8ARUOBAfCbqlWrVqzxZ86ckbu7u5KSklyKgCRVr17d+rO3t7fc3NyKtE1vb+8ijatcubLLczc3N2ty8OLFi/Xcc89p6tSpCg8Pl4+Pj15//XXt2LGjyNsoypgzZ86obdu2WrRo0WX5rrvuuiLtB4CiocAAFVCDBg3k6empxMRE1a9fX9Iv8zd27dr1m9d0adCggSpXrqwdO3aoXr16kqRTp07p0KFD+utf/ypJat26tQoKCpSZmakOHTqUSFYfHx/deOONWrdune66666r2kZiYqJuu+02DRo0yFpWGkdE2rRpoyVLlsjf31++vr4lvn0A/49JvEAFVK1aNQ0cOFAjRozQ6tWrdeDAAT311FPKyclRTEzMFV9TvXp1xcTEaMSIEVq/fr3279+vvn37qlKl//8xctNNNykqKkq9e/fWJ598oqNHj2rnzp2aMGGCVq1addV5x40bp6lTp+rNN9/U4cOHlZycrJkzZxb59Y0aNdLu3buVkJCgQ4cO6cUXX7TOuCpJUVFRqlOnjh588EF9+eWXOnr0qDZu3KghQ4bohx9+KPH3AyoyjsAAFdTEiRNVWFioJ598UqdPn1ZYWJgSEhJUs2bN33zN66+/rjNnzuj++++Xj4+Pnn32WWVnZ7uMmT9/vl555RU9++yz+vHHH1WnTh3deuutuu+++646a58+fXT+/HlNnz5dzz33nOrUqaNHHnmkyK//+9//rq+++kqPPvqo3Nzc9Nhjj2nQoEH64osvrjrTlVStWlWbN2/WP//5Tz388MM6ffq0rr/+enXu3JkjMkAJc3M6nU67QwAAABQHXyEBAADjUGAA2K569eq/+fjyyy/tjgegDOIrJAC2+/bbb39z3fXXX1/kU6kBVBwUGAAAYBy+QgIAAMahwAAAAONQYAAAgHEoMAAAwDgUGAAAYBwKDAAAMA4FBgAAGOf/AAV140ekyXAyAAAAAElFTkSuQmCC",
      "text/plain": [
       "<Figure size 640x480 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "###Top 10 people who spend the most###\n",
      "                                  master_id order_channel last_order_channel  \\\n",
      "11150  5d1c466a-9cfd-11e9-9897-000d3a38a36f   Android App            Desktop   \n",
      "4315   d5ef8058-a5c6-11e9-a2fc-000d3a38a36f   Android App        Android App   \n",
      "7613   73fd19aa-9e37-11e9-9897-000d3a38a36f       Ios App            Offline   \n",
      "13880  7137a5c0-7aad-11ea-8f20-000d3a38a36f       Ios App            Offline   \n",
      "9055   47a642fe-975b-11eb-8c2a-000d3a38a36f   Android App            Offline   \n",
      "7330   a4d534a2-5b1b-11eb-8dbd-000d3a38a36f       Desktop            Desktop   \n",
      "8068   d696c654-2633-11ea-8e1c-000d3a38a36f       Ios App            Ios App   \n",
      "163    fef57ffa-aae6-11e9-a2fc-000d3a38a36f        Mobile            Desktop   \n",
      "7223   cba59206-9dd1-11e9-9897-000d3a38a36f   Android App        Android App   \n",
      "18767  fc0ce7a4-9d87-11e9-9897-000d3a38a36f       Desktop            Desktop   \n",
      "\n",
      "      first_order_date last_order_date last_order_date_online  \\\n",
      "11150       2013-10-11      2021-04-30             2021-04-30   \n",
      "4315        2018-08-06      2021-02-23             2021-02-23   \n",
      "7613        2014-01-14      2021-05-18             2021-01-30   \n",
      "13880       2021-03-01      2021-04-13             2021-03-18   \n",
      "9055        2021-04-07      2021-04-27             2021-04-07   \n",
      "7330        2020-02-16      2021-04-30             2021-04-30   \n",
      "8068        2017-05-10      2021-04-13             2021-04-13   \n",
      "163         2016-11-08      2021-05-12             2021-05-12   \n",
      "7223        2013-02-21      2021-05-09             2021-05-09   \n",
      "18767       2018-11-24      2020-11-11             2020-11-11   \n",
      "\n",
      "      last_order_date_offline  order_num_total_ever_online  \\\n",
      "11150              2020-12-24                      200.000   \n",
      "4315               2020-07-06                       67.000   \n",
      "7613               2021-05-18                       81.000   \n",
      "13880              2021-04-13                       10.000   \n",
      "9055               2021-04-27                        1.000   \n",
      "7330               2020-12-18                       66.000   \n",
      "8068               2019-08-15                       69.000   \n",
      "163                2020-07-09                       36.000   \n",
      "7223               2020-01-25                      130.000   \n",
      "18767              2019-12-06                       18.000   \n",
      "\n",
      "       order_num_total_ever_offline  customer_value_total_ever_offline  \\\n",
      "11150                         2.000                            684.970   \n",
      "4315                          1.000                            130.490   \n",
      "7613                          1.000                           1263.760   \n",
      "13880                         1.000                            538.940   \n",
      "9055                          3.000                          18119.140   \n",
      "7330                          4.000                            843.680   \n",
      "8068                          1.000                             82.480   \n",
      "163                           1.000                            180.730   \n",
      "7223                          1.000                             49.990   \n",
      "18767                         2.000                             64.970   \n",
      "\n",
      "       customer_value_total_ever_online  \\\n",
      "11150                         45220.130   \n",
      "4315                          36687.800   \n",
      "7613                          32654.340   \n",
      "13880                         30688.470   \n",
      "9055                           2587.200   \n",
      "7330                          17599.890   \n",
      "8068                          16836.090   \n",
      "163                           12545.370   \n",
      "7223                          12232.250   \n",
      "18767                         12038.180   \n",
      "\n",
      "                        interested_in_categories_12  total_order  total_spend  \n",
      "11150  [AKTIFCOCUK, ERKEK, COCUK, KADIN, AKTIFSPOR]      202.000    45905.100  \n",
      "4315          [AKTIFCOCUK, ERKEK, KADIN, AKTIFSPOR]       68.000    36818.290  \n",
      "7613               [ERKEK, COCUK, KADIN, AKTIFSPOR]       82.000    33918.100  \n",
      "13880                     [ERKEK, KADIN, AKTIFSPOR]       11.000    31227.410  \n",
      "9055                                    [AKTIFSPOR]        4.000    20706.340  \n",
      "7330                      [ERKEK, KADIN, AKTIFSPOR]       70.000    18443.570  \n",
      "8068   [AKTIFCOCUK, ERKEK, COCUK, KADIN, AKTIFSPOR]       70.000    16918.570  \n",
      "163                              [ERKEK, AKTIFSPOR]       37.000    12726.100  \n",
      "7223          [AKTIFCOCUK, ERKEK, KADIN, AKTIFSPOR]      131.000    12282.240  \n",
      "18767                                [ERKEK, KADIN]       20.000    12103.150  \n",
      "\n",
      "\n",
      "###Top 10 people with the most orders###\n",
      "                                  master_id order_channel last_order_channel  \\\n",
      "11150  5d1c466a-9cfd-11e9-9897-000d3a38a36f   Android App            Desktop   \n",
      "7223   cba59206-9dd1-11e9-9897-000d3a38a36f   Android App        Android App   \n",
      "8783   a57f4302-b1a8-11e9-89fa-000d3a38a36f   Android App            Offline   \n",
      "2619   fdbe8304-a7ab-11e9-a2fc-000d3a38a36f   Android App            Offline   \n",
      "6322   329968c6-a0e2-11e9-a2fc-000d3a38a36f       Ios App            Ios App   \n",
      "7613   73fd19aa-9e37-11e9-9897-000d3a38a36f       Ios App            Offline   \n",
      "9347   44d032ee-a0d4-11e9-a2fc-000d3a38a36f        Mobile             Mobile   \n",
      "10954  b27e241a-a901-11e9-a2fc-000d3a38a36f        Mobile             Mobile   \n",
      "8068   d696c654-2633-11ea-8e1c-000d3a38a36f       Ios App            Ios App   \n",
      "7330   a4d534a2-5b1b-11eb-8dbd-000d3a38a36f       Desktop            Desktop   \n",
      "\n",
      "      first_order_date last_order_date last_order_date_online  \\\n",
      "11150       2013-10-11      2021-04-30             2021-04-30   \n",
      "7223        2013-02-21      2021-05-09             2021-05-09   \n",
      "8783        2019-08-07      2020-11-04             2020-09-07   \n",
      "2619        2018-10-18      2020-06-30             2018-10-18   \n",
      "6322        2019-02-14      2021-04-05             2021-04-05   \n",
      "7613        2014-01-14      2021-05-18             2021-01-30   \n",
      "9347        2019-02-11      2021-02-11             2021-02-11   \n",
      "10954       2015-09-12      2021-04-01             2021-04-01   \n",
      "8068        2017-05-10      2021-04-13             2021-04-13   \n",
      "7330        2020-02-16      2021-04-30             2021-04-30   \n",
      "\n",
      "      last_order_date_offline  order_num_total_ever_online  \\\n",
      "11150              2020-12-24                      200.000   \n",
      "7223               2020-01-25                      130.000   \n",
      "8783               2020-11-04                        2.000   \n",
      "2619               2020-06-30                        1.000   \n",
      "6322               2020-02-17                        2.000   \n",
      "7613               2021-05-18                       81.000   \n",
      "9347               2020-12-24                        3.000   \n",
      "10954              2019-10-08                       72.000   \n",
      "8068               2019-08-15                       69.000   \n",
      "7330               2020-12-18                       66.000   \n",
      "\n",
      "       order_num_total_ever_offline  customer_value_total_ever_offline  \\\n",
      "11150                         2.000                            684.970   \n",
      "7223                          1.000                             49.990   \n",
      "8783                        109.000                          10239.460   \n",
      "2619                         87.000                           8432.250   \n",
      "6322                         81.000                           3997.550   \n",
      "7613                          1.000                           1263.760   \n",
      "9347                         74.000                           4640.770   \n",
      "10954                         3.000                            292.930   \n",
      "8068                          1.000                             82.480   \n",
      "7330                          4.000                            843.680   \n",
      "\n",
      "       customer_value_total_ever_online  \\\n",
      "11150                         45220.130   \n",
      "7223                          12232.250   \n",
      "8783                            143.980   \n",
      "2619                            139.980   \n",
      "6322                            242.810   \n",
      "7613                          32654.340   \n",
      "9347                            543.280   \n",
      "10954                          5004.950   \n",
      "8068                          16836.090   \n",
      "7330                          17599.890   \n",
      "\n",
      "                        interested_in_categories_12  total_order  total_spend  \n",
      "11150  [AKTIFCOCUK, ERKEK, COCUK, KADIN, AKTIFSPOR]      202.000    45905.100  \n",
      "7223          [AKTIFCOCUK, ERKEK, KADIN, AKTIFSPOR]      131.000    12282.240  \n",
      "8783   [AKTIFCOCUK, ERKEK, COCUK, KADIN, AKTIFSPOR]      111.000    10383.440  \n",
      "2619                                        [ERKEK]       88.000     8572.230  \n",
      "6322                                        [ERKEK]       83.000     4240.360  \n",
      "7613               [ERKEK, COCUK, KADIN, AKTIFSPOR]       82.000    33918.100  \n",
      "9347                             [KADIN, AKTIFSPOR]       77.000     5184.050  \n",
      "10954         [AKTIFCOCUK, ERKEK, KADIN, AKTIFSPOR]       75.000     5297.880  \n",
      "8068   [AKTIFCOCUK, ERKEK, COCUK, KADIN, AKTIFSPOR]       70.000    16918.570  \n",
      "7330                      [ERKEK, KADIN, AKTIFSPOR]       70.000    18443.570  \n"
     ]
    }
   ],
   "source": [
    "hold_variables(df)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "aea15231",
   "metadata": {
    "collapsed": true,
    "execution": {
     "iopub.execute_input": "2024-09-09T07:32:19.192571Z",
     "iopub.status.busy": "2024-09-09T07:32:19.192079Z",
     "iopub.status.idle": "2024-09-09T07:32:19.207169Z",
     "shell.execute_reply": "2024-09-09T07:32:19.206027Z"
    },
    "jupyter": {
     "outputs_hidden": true
    },
    "papermill": {
     "duration": 0.032025,
     "end_time": "2024-09-09T07:32:19.210120",
     "exception": false,
     "start_time": "2024-09-09T07:32:19.178095",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "19945"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#df.shape \n",
    "#19945\n",
    "df[\"master_id\"].nunique() \n",
    "#19945\n",
    "#tekrar eden bir master_id yok.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "53ab69cd",
   "metadata": {
    "collapsed": true,
    "execution": {
     "iopub.execute_input": "2024-09-09T07:32:19.240861Z",
     "iopub.status.busy": "2024-09-09T07:32:19.240338Z",
     "iopub.status.idle": "2024-09-09T07:32:22.723364Z",
     "shell.execute_reply": "2024-09-09T07:32:22.721792Z"
    },
    "jupyter": {
     "outputs_hidden": true
    },
    "papermill": {
     "duration": 3.500204,
     "end_time": "2024-09-09T07:32:22.726245",
     "exception": false,
     "start_time": "2024-09-09T07:32:19.226041",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>recency</th>\n",
       "      <th>frequency</th>\n",
       "      <th>monetary</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>master_id</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>00016786-2f5a-11ea-bb80-000d3a38a36f</th>\n",
       "      <td>205</td>\n",
       "      <td>5.000</td>\n",
       "      <td>776.070</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>00034aaa-a838-11e9-a2fc-000d3a38a36f</th>\n",
       "      <td>493</td>\n",
       "      <td>3.000</td>\n",
       "      <td>269.470</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>000be838-85df-11ea-a90b-000d3a38a36f</th>\n",
       "      <td>408</td>\n",
       "      <td>4.000</td>\n",
       "      <td>722.690</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>000c1fe2-a8b7-11ea-8479-000d3a38a36f</th>\n",
       "      <td>222</td>\n",
       "      <td>7.000</td>\n",
       "      <td>874.160</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>000f5e3e-9dde-11ea-80cd-000d3a38a36f</th>\n",
       "      <td>215</td>\n",
       "      <td>7.000</td>\n",
       "      <td>1620.330</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                      recency  frequency  monetary\n",
       "master_id                                                         \n",
       "00016786-2f5a-11ea-bb80-000d3a38a36f      205      5.000   776.070\n",
       "00034aaa-a838-11e9-a2fc-000d3a38a36f      493      3.000   269.470\n",
       "000be838-85df-11ea-a90b-000d3a38a36f      408      4.000   722.690\n",
       "000c1fe2-a8b7-11ea-8479-000d3a38a36f      222      7.000   874.160\n",
       "000f5e3e-9dde-11ea-80cd-000d3a38a36f      215      7.000  1620.330"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Görev 2:  RFM Metriklerinin Hesaplanması\n",
    "#Adım 1: Recency, Frequency ve Monetary tanımlarını yapınız.\n",
    "#Adım 2: Müşteri özelinde Recency, Frequency ve Monetary metriklerini hesaplayınız.\n",
    "#Adım 3: Hesapladığınız metrikleri rfm isimli bir değişkene atayınız.\n",
    "#Adım 4: Oluşturduğunuz metriklerin isimlerini  recency, frequency ve monetary olarak değiştiriniz.\n",
    "\n",
    "\n",
    "#Recency(Yenilik):Müşterinin en son ne zaman alışveriş yaptığını ifade eder.\n",
    "#Frequency(sıklık):Müşterinin işlem sıklığıdır(toplam satın alma)\n",
    "#Monetary(Parasal Değer):Müşterinin bıraktığı parasal değer\n",
    "\n",
    "df[\"last_order_date\"].max()\n",
    "today_date = dt.datetime(2021, 12, 13)\n",
    "\n",
    "rfm = df.groupby('master_id').agg({'last_order_date': lambda recency: (today_date - recency.max()).days,\n",
    "                                     'total_order': lambda frequency: frequency,\n",
    "                                     'total_spend': lambda monetary:monetary })\n",
    "\n",
    "\n",
    "rfm.columns = ['recency', 'frequency', 'monetary']\n",
    "rfm.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "da6a1ecb",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-09-09T07:32:22.755094Z",
     "iopub.status.busy": "2024-09-09T07:32:22.753099Z",
     "iopub.status.idle": "2024-09-09T07:32:22.779402Z",
     "shell.execute_reply": "2024-09-09T07:32:22.778112Z"
    },
    "papermill": {
     "duration": 0.043675,
     "end_time": "2024-09-09T07:32:22.782333",
     "exception": false,
     "start_time": "2024-09-09T07:32:22.738658",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "#Görev 3:  RF Skorunun Hesaplanması\n",
    "# Adım 1: Recency, Frequency ve Monetary metriklerini qcut yardımı ile 1-5 arasında skorlara çeviriniz.\n",
    "\n",
    "rfm[\"recency_score\"] = pd.qcut(rfm['recency'], 5, labels=[5, 4, 3, 2, 1])\n",
    "rfm[\"frequency_score\"] = pd.qcut(rfm['frequency'].rank(method=\"first\"), 5, labels=[1, 2, 3, 4, 5])\n",
    "rfm[\"monetary_score\"] = pd.qcut(rfm['monetary'], 5, labels=[1, 2, 3, 4, 5])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "082882b1",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-09-09T07:32:22.809620Z",
     "iopub.status.busy": "2024-09-09T07:32:22.808641Z",
     "iopub.status.idle": "2024-09-09T07:32:22.847494Z",
     "shell.execute_reply": "2024-09-09T07:32:22.846254Z"
    },
    "papermill": {
     "duration": 0.055155,
     "end_time": "2024-09-09T07:32:22.850254",
     "exception": false,
     "start_time": "2024-09-09T07:32:22.795099",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>count</th>\n",
       "      <th>mean</th>\n",
       "      <th>std</th>\n",
       "      <th>min</th>\n",
       "      <th>25%</th>\n",
       "      <th>50%</th>\n",
       "      <th>75%</th>\n",
       "      <th>max</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>recency</th>\n",
       "      <td>19945.000</td>\n",
       "      <td>329.458</td>\n",
       "      <td>103.281</td>\n",
       "      <td>197.000</td>\n",
       "      <td>238.000</td>\n",
       "      <td>306.000</td>\n",
       "      <td>397.000</td>\n",
       "      <td>562.000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>frequency</th>\n",
       "      <td>19945.000</td>\n",
       "      <td>5.025</td>\n",
       "      <td>4.743</td>\n",
       "      <td>2.000</td>\n",
       "      <td>3.000</td>\n",
       "      <td>4.000</td>\n",
       "      <td>6.000</td>\n",
       "      <td>202.000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>monetary</th>\n",
       "      <td>19945.000</td>\n",
       "      <td>751.244</td>\n",
       "      <td>895.402</td>\n",
       "      <td>44.980</td>\n",
       "      <td>339.980</td>\n",
       "      <td>545.270</td>\n",
       "      <td>897.780</td>\n",
       "      <td>45905.100</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              count    mean     std     min     25%     50%     75%       max\n",
       "recency   19945.000 329.458 103.281 197.000 238.000 306.000 397.000   562.000\n",
       "frequency 19945.000   5.025   4.743   2.000   3.000   4.000   6.000   202.000\n",
       "monetary  19945.000 751.244 895.402  44.980 339.980 545.270 897.780 45905.100"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Adım 2: Bu skorları recency_score, frequency_scoreve monetary_scoreolarak kaydediniz\n",
    "rfm[\"RFM_SCORE\"] = (rfm['recency_score'].astype(str) +\n",
    "                    rfm['frequency_score'].astype(str))\n",
    "\n",
    "rfm.describe().T"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "66e0f86b",
   "metadata": {
    "collapsed": true,
    "execution": {
     "iopub.execute_input": "2024-09-09T07:32:22.880125Z",
     "iopub.status.busy": "2024-09-09T07:32:22.879622Z",
     "iopub.status.idle": "2024-09-09T07:32:23.303157Z",
     "shell.execute_reply": "2024-09-09T07:32:23.302043Z"
    },
    "jupyter": {
     "outputs_hidden": true
    },
    "papermill": {
     "duration": 0.441692,
     "end_time": "2024-09-09T07:32:23.305803",
     "exception": false,
     "start_time": "2024-09-09T07:32:22.864111",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>recency</th>\n",
       "      <th>frequency</th>\n",
       "      <th>monetary</th>\n",
       "      <th>recency_score</th>\n",
       "      <th>frequency_score</th>\n",
       "      <th>monetary_score</th>\n",
       "      <th>RFM_SCORE</th>\n",
       "      <th>segment</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>master_id</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>00016786-2f5a-11ea-bb80-000d3a38a36f</th>\n",
       "      <td>205</td>\n",
       "      <td>5.000</td>\n",
       "      <td>776.070</td>\n",
       "      <td>5</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>54</td>\n",
       "      <td>champions</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>00034aaa-a838-11e9-a2fc-000d3a38a36f</th>\n",
       "      <td>493</td>\n",
       "      <td>3.000</td>\n",
       "      <td>269.470</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>12</td>\n",
       "      <td>hibernating</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>000be838-85df-11ea-a90b-000d3a38a36f</th>\n",
       "      <td>408</td>\n",
       "      <td>4.000</td>\n",
       "      <td>722.690</td>\n",
       "      <td>2</td>\n",
       "      <td>3</td>\n",
       "      <td>4</td>\n",
       "      <td>23</td>\n",
       "      <td>at_Risk</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>000c1fe2-a8b7-11ea-8479-000d3a38a36f</th>\n",
       "      <td>222</td>\n",
       "      <td>7.000</td>\n",
       "      <td>874.160</td>\n",
       "      <td>5</td>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>54</td>\n",
       "      <td>champions</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>000f5e3e-9dde-11ea-80cd-000d3a38a36f</th>\n",
       "      <td>215</td>\n",
       "      <td>7.000</td>\n",
       "      <td>1620.330</td>\n",
       "      <td>5</td>\n",
       "      <td>4</td>\n",
       "      <td>5</td>\n",
       "      <td>54</td>\n",
       "      <td>champions</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                                      recency  frequency  monetary  \\\n",
       "master_id                                                            \n",
       "00016786-2f5a-11ea-bb80-000d3a38a36f      205      5.000   776.070   \n",
       "00034aaa-a838-11e9-a2fc-000d3a38a36f      493      3.000   269.470   \n",
       "000be838-85df-11ea-a90b-000d3a38a36f      408      4.000   722.690   \n",
       "000c1fe2-a8b7-11ea-8479-000d3a38a36f      222      7.000   874.160   \n",
       "000f5e3e-9dde-11ea-80cd-000d3a38a36f      215      7.000  1620.330   \n",
       "\n",
       "                                     recency_score frequency_score  \\\n",
       "master_id                                                            \n",
       "00016786-2f5a-11ea-bb80-000d3a38a36f             5               4   \n",
       "00034aaa-a838-11e9-a2fc-000d3a38a36f             1               2   \n",
       "000be838-85df-11ea-a90b-000d3a38a36f             2               3   \n",
       "000c1fe2-a8b7-11ea-8479-000d3a38a36f             5               4   \n",
       "000f5e3e-9dde-11ea-80cd-000d3a38a36f             5               4   \n",
       "\n",
       "                                     monetary_score RFM_SCORE      segment  \n",
       "master_id                                                                   \n",
       "00016786-2f5a-11ea-bb80-000d3a38a36f              4        54    champions  \n",
       "00034aaa-a838-11e9-a2fc-000d3a38a36f              1        12  hibernating  \n",
       "000be838-85df-11ea-a90b-000d3a38a36f              4        23      at_Risk  \n",
       "000c1fe2-a8b7-11ea-8479-000d3a38a36f              4        54    champions  \n",
       "000f5e3e-9dde-11ea-80cd-000d3a38a36f              5        54    champions  "
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Görev 4:  RF Skorunun SegmentOlarak Tanımlanması\n",
    "#Adım 1: Oluşturulan RF skorları için segment tanımlamaları yapınız.\n",
    "seg_map = {\n",
    "    r'[1-2][1-2]': 'hibernating',\n",
    "    r'[1-2][3-4]': 'at_Risk',\n",
    "    r'[1-2]5': 'cant_loose',\n",
    "    r'3[1-2]': 'about_to_sleep',\n",
    "    r'33': 'need_attention',\n",
    "    r'[3-4][4-5]': 'loyal_customers',\n",
    "    r'41': 'promising',\n",
    "    r'51': 'new_customers',\n",
    "    r'[4-5][2-3]': 'potential_loyalists',\n",
    "    r'5[4-5]': 'champions'\n",
    "}\n",
    "\n",
    "rfm['segment'] = rfm['RFM_SCORE'].replace(seg_map, regex=True)\n",
    "rfm.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "c9c681d0",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-09-09T07:32:23.333668Z",
     "iopub.status.busy": "2024-09-09T07:32:23.333160Z",
     "iopub.status.idle": "2024-09-09T07:32:23.368882Z",
     "shell.execute_reply": "2024-09-09T07:32:23.367656Z"
    },
    "papermill": {
     "duration": 0.053131,
     "end_time": "2024-09-09T07:32:23.371568",
     "exception": false,
     "start_time": "2024-09-09T07:32:23.318437",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead tr th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe thead tr:last-of-type th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr>\n",
       "      <th></th>\n",
       "      <th colspan=\"2\" halign=\"left\">recency</th>\n",
       "      <th colspan=\"2\" halign=\"left\">frequency</th>\n",
       "      <th colspan=\"2\" halign=\"left\">monetary</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th></th>\n",
       "      <th>mean</th>\n",
       "      <th>count</th>\n",
       "      <th>mean</th>\n",
       "      <th>count</th>\n",
       "      <th>mean</th>\n",
       "      <th>count</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>segment</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>about_to_sleep</th>\n",
       "      <td>309.032</td>\n",
       "      <td>1643</td>\n",
       "      <td>2.407</td>\n",
       "      <td>1643</td>\n",
       "      <td>361.649</td>\n",
       "      <td>1643</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>at_Risk</th>\n",
       "      <td>437.329</td>\n",
       "      <td>3152</td>\n",
       "      <td>4.470</td>\n",
       "      <td>3152</td>\n",
       "      <td>648.325</td>\n",
       "      <td>3152</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>cant_loose</th>\n",
       "      <td>430.159</td>\n",
       "      <td>1194</td>\n",
       "      <td>10.717</td>\n",
       "      <td>1194</td>\n",
       "      <td>1481.652</td>\n",
       "      <td>1194</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>champions</th>\n",
       "      <td>212.142</td>\n",
       "      <td>1920</td>\n",
       "      <td>8.965</td>\n",
       "      <td>1920</td>\n",
       "      <td>1410.709</td>\n",
       "      <td>1920</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>hibernating</th>\n",
       "      <td>442.426</td>\n",
       "      <td>3589</td>\n",
       "      <td>2.391</td>\n",
       "      <td>3589</td>\n",
       "      <td>362.583</td>\n",
       "      <td>3589</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>loyal_customers</th>\n",
       "      <td>277.558</td>\n",
       "      <td>3375</td>\n",
       "      <td>8.356</td>\n",
       "      <td>3375</td>\n",
       "      <td>1216.257</td>\n",
       "      <td>3375</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>need_attention</th>\n",
       "      <td>308.037</td>\n",
       "      <td>806</td>\n",
       "      <td>3.739</td>\n",
       "      <td>806</td>\n",
       "      <td>553.437</td>\n",
       "      <td>806</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>new_customers</th>\n",
       "      <td>212.976</td>\n",
       "      <td>673</td>\n",
       "      <td>2.000</td>\n",
       "      <td>673</td>\n",
       "      <td>344.049</td>\n",
       "      <td>673</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>potential_loyalists</th>\n",
       "      <td>231.870</td>\n",
       "      <td>2925</td>\n",
       "      <td>3.311</td>\n",
       "      <td>2925</td>\n",
       "      <td>533.741</td>\n",
       "      <td>2925</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>promising</th>\n",
       "      <td>253.695</td>\n",
       "      <td>668</td>\n",
       "      <td>2.000</td>\n",
       "      <td>668</td>\n",
       "      <td>334.153</td>\n",
       "      <td>668</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                    recency       frequency       monetary      \n",
       "                       mean count      mean count     mean count\n",
       "segment                                                         \n",
       "about_to_sleep      309.032  1643     2.407  1643  361.649  1643\n",
       "at_Risk             437.329  3152     4.470  3152  648.325  3152\n",
       "cant_loose          430.159  1194    10.717  1194 1481.652  1194\n",
       "champions           212.142  1920     8.965  1920 1410.709  1920\n",
       "hibernating         442.426  3589     2.391  3589  362.583  3589\n",
       "loyal_customers     277.558  3375     8.356  3375 1216.257  3375\n",
       "need_attention      308.037   806     3.739   806  553.437   806\n",
       "new_customers       212.976   673     2.000   673  344.049   673\n",
       "potential_loyalists 231.870  2925     3.311  2925  533.741  2925\n",
       "promising           253.695   668     2.000   668  334.153   668"
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Görev 5:  Aksiyon Zamanı !\n",
    "# Adım1:  Segmentlerin recency, frequnecy ve monetary ortalamalarını inceleyiniz.\n",
    "rfm[[\"segment\", \"recency\", \"frequency\", \"monetary\"]].groupby(\"segment\").agg([\"mean\", \"count\"])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "0d1bfa3f",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-09-09T07:32:23.400585Z",
     "iopub.status.busy": "2024-09-09T07:32:23.399515Z",
     "iopub.status.idle": "2024-09-09T07:32:23.470653Z",
     "shell.execute_reply": "2024-09-09T07:32:23.469324Z"
    },
    "papermill": {
     "duration": 0.089116,
     "end_time": "2024-09-09T07:32:23.473628",
     "exception": false,
     "start_time": "2024-09-09T07:32:23.384512",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "# Adım2: RFM analizi yardımıyla aşağıda verilen 2 case için ilgili profildeki müşterileri bulun ve müşteri id'lerini csv olarak kaydediniz.\n",
    "#a. FLO bünyesine yeni bir kadın ayakkabı markası dahil ediyor. Dahil ettiği markanın ürün fiyatları genel müşteri tercihlerinin üstünde. Bu nedenle markanın tanıtımı ve ürün satışları için ilgilenecek profildeki müşterilerle özel olarak iletişime geçmek isteniliyor. Sadık müşterilerinden(champions, loyal_customers) ve kadın kategorisinden alışveriş yapan kişiler özel olarak iletişim kurulacak müşteriler. Bu müşterilerin id numaralarını csv dosyasına kaydediniz.\n",
    "rfm.reset_index()\n",
    "new_df = pd.DataFrame()\n",
    "new_rfm=pd.merge(df,rfm,on = 'master_id', how='left')\n",
    "\n",
    "new_df[\"new_customer_id\"]=new_rfm[((new_rfm[\"segment\"] == \"champions\")|(new_rfm[\"segment\"] == \"loyal_customers\"))&(new_rfm[\"interested_in_categories_12\"].apply(lambda x: 'KADIN' in x))].index\n",
    "\n",
    "new_df[\"new_customer_id\"] = new_df[\"new_customer_id\"].astype(int)\n",
    "\n",
    "new_df.to_csv(\"new_customers.csv\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "93313318",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-09-09T07:32:23.502623Z",
     "iopub.status.busy": "2024-09-09T07:32:23.502011Z",
     "iopub.status.idle": "2024-09-09T07:32:23.533838Z",
     "shell.execute_reply": "2024-09-09T07:32:23.532560Z"
    },
    "papermill": {
     "duration": 0.050137,
     "end_time": "2024-09-09T07:32:23.537189",
     "exception": false,
     "start_time": "2024-09-09T07:32:23.487052",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "# b. Erkek ve Çocuk ürünlerinde %40'a yakın indirim planlanmaktadır. Bu indirimle ilgili kategorilerle ilgilenen geçmişte iyi müşteri olan ama uzun süredir alışveriş yapmayan kaybedilmemesi gereken müşteriler, uykuda olanlar ve yeni gelen müşteriler özel olarak hedef alınmak isteniyor. Uygun profildeki müşterilerin id'lerini csv dosyasına kaydediniz.\n",
    "new_df2 = pd.DataFrame()\n",
    "new_df2[\"new_customer_id\"]=new_rfm[(new_rfm[\"segment\"] == \"cant_loose\")|(new_rfm[\"segment\"] == \"about_to_sleep\")|(new_rfm[\"segment\"] == \"new_customers\")].index\n",
    "new_df2[\"new_customer_id\"] = new_df2[\"new_customer_id\"].astype(int)\n",
    "\n",
    "new_df2.to_csv(\"new_customers2.csv\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "daf1fef8",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-09-09T07:32:23.566190Z",
     "iopub.status.busy": "2024-09-09T07:32:23.565675Z",
     "iopub.status.idle": "2024-09-09T07:32:23.571087Z",
     "shell.execute_reply": "2024-09-09T07:32:23.569982Z"
    },
    "papermill": {
     "duration": 0.022831,
     "end_time": "2024-09-09T07:32:23.573630",
     "exception": false,
     "start_time": "2024-09-09T07:32:23.550799",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "#new_df3 = pd.DataFrame()\n",
    "#new_df3=new_rfm[(new_rfm[\"segment\"] == \"cant_loose\")|(new_rfm[\"segment\"] == \"about_to_sleep\")|(new_rfm[\"segment\"] == \"new_customers\")]\n",
    "\n",
    "#new_df3.to_csv(\"new_customers.csv\")"
   ]
  }
 ],
 "metadata": {
  "kaggle": {
   "accelerator": "none",
   "dataSources": [
    {
     "datasetId": 5659730,
     "sourceId": 9339367,
     "sourceType": "datasetVersion"
    }
   ],
   "dockerImageVersionId": 30761,
   "isGpuEnabled": false,
   "isInternetEnabled": true,
   "language": "python",
   "sourceType": "notebook"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.14"
  },
  "papermill": {
   "default_parameters": {},
   "duration": 12.106477,
   "end_time": "2024-09-09T07:32:24.311874",
   "environment_variables": {},
   "exception": null,
   "input_path": "__notebook__.ipynb",
   "output_path": "__notebook__.ipynb",
   "parameters": {},
   "start_time": "2024-09-09T07:32:12.205397",
   "version": "2.6.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
